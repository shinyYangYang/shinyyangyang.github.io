<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ¬¢è¿æ‚¨ç»™æˆ‘æŒ‡å‡ºé—®é¢˜</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-01-03T01:29:01.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>æ¨é˜³</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>è¿­ä»£å™¨å’Œç”Ÿæˆå™¨--python</title>
    <link href="http://yoursite.com/2018/01/02/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8-python/"/>
    <id>http://yoursite.com/2018/01/02/è¿­ä»£å™¨å’Œç”Ÿæˆå™¨-python/</id>
    <published>2018-01-02T05:55:33.000Z</published>
    <updated>2018-01-03T01:29:01.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¯è¿­ä»£å¯¹è±¡-iterable"><a href="#å¯è¿­ä»£å¯¹è±¡-iterable" class="headerlink" title="å¯è¿­ä»£å¯¹è±¡(iterable)"></a>å¯è¿­ä»£å¯¹è±¡(iterable)</h2><p>å¸¸è§çš„å¯è¿­ä»£å¯¹è±¡æ¯”å¦‚ list, set, deque, dict, tuple ç­‰å®¹å™¨. åªè¦èƒ½è¿”å›ä¸€ä¸ª<strong>è¿­ä»£å™¨</strong>çš„å¯¹è±¡éƒ½å¯ç§°ä¸ºå¯è¿­ä»£å¯¹è±¡, è¿™é‡Œä¸€ä¸ªæ¦‚å¿µä¾èµ–äº†å¦ä¸ªæ¦‚å¿µ. ä¸¾ä¾‹è¯´æ˜ä¸‹:</p>
<pre><code>list1 = [1, 2, 3, 4, 5]
for i in list1:
    print(&apos;for in &apos;, i)

outputs:    
for in  1
for in  2
for in  3
for in  4
for in  5

# æ‰‹åŠ¨è¿­ä»£:
iterList = iter(list1) #è¿”å›çš„è¿­ä»£å™¨
try:
    while True:
        i = next(iterList) # å®ç°äº†next()æ–¹æ³•
        print(&apos;custom iter&apos;, i)

except StopIteration as e:
     print(e.value, e.args)

outputs:
custom iter 1
custom iter 2
custom iter 3
custom iter 4
custom iter 5
None ()
</code></pre><p><strong>è¯´æ˜:</strong></p>
<blockquote>
<ol>
<li>listæœ¬èº«å°±æ˜¯å¯è¿­ä»£å¯¹è±¡.</li>
<li>iter() ç”¨äºè¿”å›å¯¹è±¡çš„è¿­ä»£å™¨</li>
<li>å¯è¿­ä»£å¯¹è±¡éƒ½å®ç°äº†next()æ–¹æ³•, å½“æ²¡æœ‰å€¼å¯ä»¥è¿”å›åæŠ›å‡º <strong>StopIteration</strong> å¼‚å¸¸</li>
</ol>
</blockquote>
<p>å…³äº<code>iter()</code> å‡½æ•°, æœ‰ä¸¤ä¸ªå‚æ•°å…ˆè¯´ç¬¬ä¸€ä¸ªå‚æ•°, ä¹Ÿæ˜¯åˆ—å­ä¸­çš„å½“è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå®¹å™¨æ—¶å€™, æ¯æ¬¡éƒ½ä¼šè¿”å›è¿™ä¸ªå®¹å™¨æ–°çš„è¿­ä»£å™¨, å¦‚æœè¿™ä¸ªå‚æ•°æœ¬èº«å°±æ˜¯ä¸€ä¸ªè¿­ä»£å™¨, åˆ™ç›´æ¥è¿”å›è¿™ä¸ªè¿­ä»£å™¨. åˆ©ç”¨è¿™ç‚¹, åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯è¿­ä»£å™¨è¿˜æ˜¯å®¹å™¨, å°±ç”¨å®ƒå½“åš<code>iter()</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸¤æ¬¡è°ƒç”¨, å¦‚æœè¿”å›ä¸€æ ·, åˆ™æ˜¯è¿­ä»£å™¨.<br>ç¬¬äºŒå‚æ•°æ˜¯ è¿­ä»£åˆ°è¿™ä¸ªå€¼ååœæ­¢è¿­ä»£. <code>num = iter(random_num, 1)</code> å½“numä¸­nextå€¼ä¸º1çš„æ—¶å€™å°±æŠ›å‡º<code>StopIteration</code>å¼‚å¸¸,ç»“æŸè¿­ä»£  </p>
<p>è¿™é‡Œå¯ä»¥çœ‹å‡º list è¿™ç±»ç³»ç»Ÿçš„å®¹å™¨ç±», é»˜è®¤å®ç°äº†iter() å’Œ next() æ–¹æ³•. ä¹Ÿå°±æ˜¯ä¸‹é¢è¦è¯´çš„è¿­ä»£å™¨åè®®.<br>å¦‚æœè¦è‡ªå·±å®ç°ä¸€ä¸ªç±»ä¼¼ for in éå†, åœ¨pythonä¸­ ä¹Ÿå¯ä»¥å…ˆ è·å–è¿­ä»£å™¨ (itertor) ç„¶åå¾ªç¯å»è°ƒç”¨next() ç„¶ååˆ°æ²¡æœ‰å€¼å¾—æ—¶å€™å¤„ç†å¼‚å¸¸, é€€å‡ºå¾ªç¯.</p>
<h2 id="è¿­ä»£å™¨åè®®"><a href="#è¿­ä»£å™¨åè®®" class="headerlink" title="è¿­ä»£å™¨åè®®"></a>è¿­ä»£å™¨åè®®</h2><p>è¿­ä»£åè®®è¦æ±‚ä¸€ä¸ª <strong>__iter__()</strong>æ–¹æ³•è¿”å›ä¸€ä¸ªç‰¹æ®Šçš„è¿­ä»£å™¨å¯¹è±¡ï¼Œè¿™ä¸ªè¿­ä»£å™¨å¯¹è±¡å®ç°äº† <strong>__next__()</strong> æ–¹æ³•å¹¶é€šè¿‡ StopIteration å¼‚å¸¸æ ‡è¯†è¿­ä»£çš„å®Œæˆ.</p>
<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦è‡ªå·±ç±»æ”¯å‡ºè¿­ä»£å°±è¦éœ€è¦å®ç°ä¸‹é¢è¦æ±‚:</p>
<blockquote>
<ol>
<li>è¦å®ç°<strong>__iter__()</strong>æ–¹æ³•, å¹¶ä¸”è¿™ä¸ªæ–¹æ³•è¦è¿”å›ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡. å¦‚æœè¿™é‡Œæˆ‘ä»¬è¿”å›çš„æ˜¯ ç³»ç»Ÿå¯è¿­ä»£çš„å¯¹è±¡, æˆ‘ä»¬å°±ä¸ç”¨æ‹…å¿ƒä¸‹é¢çš„ä¸¤ç‚¹äº†, æ¯”å¦‚è¿”å›çš„æ˜¯ç±»ä¼¼ä¸Šé¢ç”¨åˆ°çš„ iterList .</li>
<li>è¿™ä¸ªè¿­ä»£å™¨å¯¹è±¡å®ç°äº†<strong>__next__()</strong>æ–¹æ³•</li>
<li>åœ¨æ²¡æœ‰å€¼çš„æ—¶å€™è¦æŠ›å‡º <strong>StopIteration</strong> å¼‚å¸¸, ç”¨æ¥è¡¨ç¤ºè¿­ä»£å·²ç»å®Œæˆäº†. è¿™ä¸ªå¼‚å¸¸æ—¶æœºæ˜¯åœ¨<strong>__next__()</strong>æ–¹æ³•ä¸­.</li>
</ol>
</blockquote>
<pre><code>class CustomList(object):

    def __init__(self):

        self._list = [1, 2, 3, 4, 5]


    def __iter__(self):

        return iter(self._list) # è¿”å›çš„æ˜¯ listçš„è¿­ä»£å™¨å¯¹è±¡, ç”±äºç³»ç»Ÿç»™listå®ç°äº† __next__() æ‰€ä»¥æˆ‘ä»¬ä¸ç”¨å¤„ç†

arr = CustomList()
for i in arr:
       print(i)

outputs:
1, 2, 3, 4, 5
</code></pre><p>è¿™é‡Œç”±äºæˆ‘ä»¬åœ¨__iter__() æ–¹æ³•ä¸­è¿”å›çš„æ˜¯ç³»ç»Ÿlistçš„è¿­ä»£å™¨, å› ä¸ºæˆ‘ä»¬çŸ¥é“listå·²ç»å®ç°äº†__next__()æ–¹æ³•, æ‰€ä»¥æˆ‘ä»¬ä¸ç”¨ç®¡.<br>è¿™é‡Œçš„åˆ—å­ä¸å¤ªåˆé€‚, å…¶å®å°±æ˜¯å¥—äº†ä¸ªå£³, é‡Œé¢è¿˜æ˜¯ç³»ç»Ÿçš„list. å¤§å®¶å°±å°†å°±ä¸‹, ä¸€æ—¶é—´æƒ³ä¸åˆ°å¥½çš„åœºæ™¯. æ¥ç€æˆ‘ä»¬æ¥è¯•è¯•åœ¨__iter__()ä¸­è¿”å›è‡ªå·±çš„å¯¹è±¡</p>
<pre><code>class CustomList1(object):

    def __init__(self):

        self._range = range(5)
        self._index = -1

    def __iter__(self):

        return self # è¿”å›çš„æ˜¯ è‡ªå®šä¹‰å¯¹è±¡, å› æ­¤æˆ‘ä»¬è¦è‡ªå·±å®ç° __next__() , å¦åˆ™ä¼šåœ¨for in æ—¶ç”±äºæ‰¾ä¸åˆ°next()æ–¹æ³•è€ŒæŠ¥é”™.

    def __next__(self):

        self._index = self._index + 1

        if self._range and self._index &lt; 5:
            return self._range[self._index]
        else:
             raise StopIteration

arr1 = CustomList1()
for i in arr1:
    print(i)


  outputs:
1, 2, 3, 4, 5
</code></pre><p>ä»£ç ä¸­çš„å‘½åä»€ä¹ˆçš„ä¸è¦å¤ªåœ¨æ„å•¦ğŸ˜…, ç›´æ¥çœ‹é‡ç‚¹, è¿™é‡Œæˆ‘ä»¬åœ¨__iter__() è¿”å›äº†self, æ„å‘³ç€selfå°±æ˜¯è¿­ä»£å™¨å¯¹è±¡, å•ç‹¬æŠ½ç¦»æ¥çœ‹ self å’Œ è¿­ä»£å™¨å¯¹è±¡å®åœ¨å¾ˆéš¾æƒ³åˆ°ä¸€å—å», å°±å› ä¸ºåœ¨__iter__() è¿”å›äº†self, ç„¶åå®ç°äº† __next__()æ–¹æ³•å°±å˜æˆäº†å¯è¿­ä»£çš„è¿­ä»£å™¨å¯¹è±¡äº†. æ‰€ä»¥ä¸‹é¢çš„è¿­ä»£å™¨æˆ‘ä»¬å…¶å®å·²ç»å¼„çš„å·®ä¸å¤šäº†.</p>
<p>ä»£ç ä¸­è™½è¯´æˆ‘ä»¬ç”¨äº† range è¿™ä¸ªç³»ç»Ÿçš„å¯è¿­ä»£å¯¹è±¡, ä½†æ˜¯æˆ‘ä»¬åœ¨è¿­ä»£è¿‡ç¨‹ä¸­, å¹¶æ²¡æœ‰ç”¨rangeçš„è¿­ä»£å™¨, åªæ˜¯ç”¨äº†ä»–çš„å®¹å™¨åŠŸèƒ½. ä¹Ÿå¯ä»¥è‡ªå·±è¯•ä¸‹, è¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬ä¸å®ç° __next__()æ–¹æ³•, åœ¨ <code>for in</code> ä¸­ç›´æ¥å›æŠ¥é”™, å› ä¸ºæ‰¾ä¸åˆ°next()æ–¹æ³•</p>
<p>è¿™é‡Œå¦‚æœæˆ‘ä»¬ä¸æŠ›å‡º <strong>å¼‚å¸¸ StopIteration</strong>, é‚£ä¹ˆå°±ä¼š<code>for in</code> ä¸€ç›´<code>next</code>, å½“<code>_index</code>è¶…è¿‡æ—¶å€™, <code>range</code>å°±ä¼šæŠ›å‡ºå¼‚å¸¸, è¯´æˆ‘ä»¬è¶Šç•Œ.</p>
<h2 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" class="headerlink" title="è¿­ä»£å™¨"></a>è¿­ä»£å™¨</h2><p>æˆ‘ä»¬è‡ªå·±æ¥ç»™å®ƒä¸‹ä¸€ä¸ªå®šä¹‰:</p>
<blockquote>
<ol>
<li>è¦å®ç°__iter__()æ–¹æ³•, å¹¶ä¸”è¿”å›çš„æ˜¯ self. (å¦‚æœè¿”å›çš„æ˜¯ç³»ç»Ÿçš„æˆ–è€…åˆ«çš„è¿­ä»£å™¨å¯¹è±¡, é‚£èƒ½ä¸èƒ½ä¹Ÿç®—å½“å‰è¿™ä¸ªç±»çš„, ä¾‹å¦‚ä¸Šé¢çš„ç¬¬ä¸€ç§æƒ…, æˆ‘ä¸çŸ¥é“, ä¹Ÿä¸çº ç»“äº†, è¿™é‡Œæš‚ä¸”å…ˆä¸ç®—å§)</li>
<li>è¦å®ç°__next__()æ–¹æ³•, å¹¶ä¸”åœ¨æ²¡æœ‰å€¼çš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸ StopIteration</li>
<li>è¦æ¯æ¬¡éƒ½è¿”å›ä¸ä¸€æ ·çš„å€¼, è¿˜åº”è¯¥è¦è®°å½•å½“å‰çš„çŠ¶æ€, ä¸Šåˆ—ä¸­ç”¨self._index è®°å½•äº†å½“å‰çš„ä½ç½®</li>
</ol>
</blockquote>
<h2 id="ç”Ÿæˆå™¨"><a href="#ç”Ÿæˆå™¨" class="headerlink" title="ç”Ÿæˆå™¨"></a>ç”Ÿæˆå™¨</h2><p>ç”Ÿæˆå™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿­ä»£å™¨ å®ƒä¸éœ€è¦å†åƒä¸Šé¢çš„ç±»ä¸€æ ·å†™__iter__()å’Œ__next__()æ–¹æ³•äº†ï¼Œåªéœ€è¦ä¸€ä¸ª<strong>yiled</strong>å…³é”®å­—ã€‚ç”Ÿæˆå™¨ä»¥ä¸€ç§æ‡’åŠ è½½çš„æ¨¡å¼ç”Ÿæˆå€¼. </p>
<p><strong>ç‰¹æ€§:</strong></p>
<blockquote>
<ol>
<li>å¯è¿­ä»£</li>
<li>æ‡’åŠ è½½</li>
<li>çŠ¶æ€ä¿å­˜</li>
<li>ä½¿ç”¨<code>yiled</code> å…³é”®å­—, æˆ–è€…ç”Ÿæˆå™¨è¡¨è¾¾å¼ åˆ›å»º.</li>
</ol>
</blockquote>
<pre><code>def gensquares(n):

for i in range(n):
    yield i ** 2

for item in gensquares(5):
    print(item)

outputs:
0, 1, 4, 9, 16
</code></pre><p>ç”Ÿæˆå™¨è¡¨è¾¾å¼å’Œåˆ—è¡¨æ¨åˆ°å¼å°±åªæœ‰ æ–¹æ‹¬å·å’Œ åœ†æ‹¬å·çš„åŒºåˆ«:</p>
<pre><code># åˆ—è¡¨æ¨å¯¼å¼
squares = [x ** 2 for x in range(5)]
print(squares)

output:
[0, 1, 4, 9, 16]

ç”Ÿæˆå™¨è¡¨è¾¾å¼:
squares = (x ** 2 for x in range(5))
print(squares)

for x in squares:
       print(x)

   outputs:
   &lt;generator object &lt;genexpr&gt; at 0x10e1a6410&gt;
0, 1, 4, 9, 16
</code></pre><p>æœ‰äººè¯´<code>yield</code>ç›¸å½“äº <code>return</code> è¿™é‡Œä¸¾ä¾‹æ¥çœ‹ä¸‹</p>
<pre><code>def frange(start, stop, increment):
x = start
while x &lt; stop:

    yield 8
    yield x  # è¿™é‡Œè¿”å›äº†ä¸€ä¸ªå€¼å, ä¸‹é¢çš„ä»£ç è¿˜æ˜¯æœ‰æ‰§è¡Œ
    x += increment


for n in frange(0, 4, 1):
    print(n)

outputs:
8, 0, 8, 1, 8, 2, 8, 3
</code></pre><blockquote>
<ol>
<li><code>return</code> åé¢çš„ä»£ç ä¸ä¼šæ‰§è¡Œ, <code>yield</code>åé¢çš„ä»£ç è¿˜æ˜¯ä¼šæ‰§è¡Œ.</li>
<li>å¤šä¸ª<code>return</code>æ—¶å€™, æ°¸è¿œåªæœ‰ç¬¬ä¸€ä¸ª<code>retrun</code>å€¼ä¼šè¢«è¿”å›, å¤šä¸ª<code>yield</code>æ—¶å€™, ä¸€æ¬¡ä¹Ÿåªæœ‰ç¬¬ä¸€ä¸ªè¿”å›, ä½†æ˜¯ä»–ä¼šè®°å½•ä¸Šæ¬¡è¿”å›<code>yield</code>çš„ä½ç½®. æ¯”å¦‚ä¸Šåˆ—ä¸­ ç¬¬ä¸€æ¬¡ è¿”å›çš„ç¬¬ä¸€ä¸ª<code>yield 8</code>, ç¬¬äºŒæ¬¡è¿”å›çš„æ˜¯ç¬¬äºŒä¸ª<code>yield 0</code>, ä¸‰æ¬¡åˆæ˜¯ç¬¬ä¸€ä¸ª<code>yield 8</code>â€¦ ä¹Ÿå°±æ˜¯è¯´ç”Ÿæˆå™¨ä¸­æœ‰ 8ä¸ªå…ƒç´ . å¦‚æœä½¿ç”¨<code>return</code> æ°¸è¿œåªä¼šè¿”å›8.</li>
</ol>
</blockquote>
<p><strong>ä¸€ä¸ªç”Ÿæˆå™¨åªèƒ½éå†è¯»å–ä¸€æ¬¡:</strong></p>
<pre><code>def frange(start, stop, increment):
x = start
while x &lt; stop:
    yield x  # è¿™é‡Œè¿”å›äº†ä¸€ä¸ªå€¼å, ä¸‹é¢çš„ä»£ç è¿˜æ˜¯æœ‰æ‰§è¡Œ
    x += increment

r = frange(0, 4, 1)

print(next(r))
print(next(r))
print(next(r))
print(next(r))

outputs:
0, 1, 2, 3
</code></pre><p>å¦‚æœå†åŠ ä¸€ä¸ª <code>print(next(r))</code> å°±ä¼šæŠ¥é”™, æç¤ºå¼‚å¸¸  <code>print(next(r)) StopIteration</code>. </p>
<p>ç°åœ¨å¯ä»¥æƒ³è±¡ä¸‹, åœ¨è‡ªå·±å®ç°è¿­ä»£å™¨æ—¶å€™, æˆ‘ä»¬åœ¨__iter__()æ–¹æ³•ä¸­, å¦‚æœè¿”å›ä¸€ä¸ª ç”Ÿæˆå™¨, æ˜¯å¦å¯è¡Œ, è€Œä¸”ä¸ç”¨å»å®ç°__next__()æ–¹æ³•ä¹Ÿ<strong>ä¸ä¼šæŠ¥é”™</strong>,å› ä¸ºç”Ÿæˆå™¨å¯¹è±¡é»˜è®¤ä¼šå®ç°, åªæ˜¯ç»“æœæ˜¯ä¸æ˜¯æƒ³è¦çš„å°±è¦æ€è€ƒä¸‹äº†.<br>è¿™é‡Œæ¥æ”¹ä¸‹ä¸Šé¢é‚£ä¸ªä¾‹å­, ç”¨ç”Ÿæˆå™¨æ”¹:</p>
<pre><code>class CustomList1(object):

def __init__(self):

        self._range = range(5)
        self._index = -1

    def __iter__(self):

        yield self


arr1 = CustomList1()
for i in arr1:
    print(i)

output: 
&lt;__main__.CustomList1 object at 0x1046deeb8&gt;
</code></pre><p> è¿™ä¸ªæ—¶å€™è¿”å›çš„æ˜¯ self è¿™ä¸ªå¯¹è±¡. é‚£æ˜¯ä¸æ˜¯æˆ‘ä»¬æŠŠ <code>__next__()</code> ä¹Ÿå®ç°å°±å¥½äº†?  å…¶å®ä¹Ÿæ˜¯ä¸€æ ·çš„, å› ä¸ºæ ¹æœ¬ä¸ä¼šå»è°ƒç”¨<code>__next__()</code>æ–¹æ³•. è‡³äºä¸ºå•¥ä¸ä¼šè°ƒç”¨, çŒœæƒ³çš„åŸå› æ˜¯ è¿™é‡Œè¿”å›çš„æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨, è€Œä¸æ˜¯è¿­ä»£å™¨, ç”Ÿæˆå™¨çš„æ˜¯ä¸€ä¸ªç³»ç»Ÿçš„ç±», è€Œè¿™é‡Œçš„<code>self</code>åªæ˜¯ ç”Ÿæˆå™¨å¯¹è±¡é‡Œçš„å®¹å™¨ä¸­çš„ä¸€ä¸ªå…ƒç´ . ä¹Ÿå°±æ˜¯è¯´ è¿™é‡Œè°ƒç”¨çš„æ˜¯ ç”Ÿæˆå™¨è¿™ä¸ªç±»çš„ <code>__next__()</code>æ–¹æ³•. è€Œä¸æ˜¯ selfçš„ <code>__next__()</code>.  ä¸¾ä¸ªä¾‹å­<br> <code>list1 = [1, 2, 3, 4]</code>  æˆ‘ä»¬åœ¨è¿­ä»£ listæ—¶å€™, æˆ‘ä»¬è°ƒç”¨çš„æ˜¯ list è¿™ä¸ªç±»å®ç°çš„<code>__next__()</code>æ–¹æ³•(å¯¹åº” ç”Ÿæˆå™¨), è€Œä¸æ˜¯listä¸­çš„å…ƒç´ çš„ 1æˆ–è€… 2 æˆ–è€… 3 ,4 çš„<code>next()</code> æ–¹æ³•(å¯¹åº”ä¾‹å­ä¸­çš„self).</p>
<p>è¦æ€æ ·æ‰èƒ½è¿”å›æˆ‘ä»¬æƒ³è¦çš„å‘¢? </p>
<pre><code>class CustomList1(object):

    def __init__(self):

        self._range = range(5)

    def __iter__(self):

        for i in self._range:
            yield i

arr1 = CustomList1()
for i in arr1:
    print(i)

arrIter = iter(arr1)
print(next(arrIter))
print(next(arrIter))
print(next(arrIter))
print(next(arrIter))
print(next(arrIter))

for in outputs: 
 0, 1, 2, 3, 4

 print outputs:
 0, 1, 2, 3, 4
</code></pre><p>è¿™ä¸ªç»“æœç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚, ä½†æ˜¯è¿™é‡Œä¸ºå•¥å¯ä»¥è¾“å‡ºä¸¤æ¬¡å‘¢? ä¸æ˜¯è¯´åªèƒ½è®¿é—®ä¸€æ¬¡å—? è¿™é‡Œæ˜¯å› ä¸ºè·å–äº†ä¸¤æ¬¡<code>arr1</code>å¯¹è±¡ çš„ è¿­ä»£å™¨å¯¹è±¡, è¿™ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€æ ·çš„. å½“æˆ‘ä»¬åœ¨å¾€åé¢åŠ ä¸€ä¸ª<code>print(next(arrIter))</code> é©¬ä¸Šå°±ä¼šæŠ¥å¼‚å¸¸ <code>StopIteration</code> å› ä¸ºåªèƒ½è¿”å›ä¸€æ¬¡.<br>ä¹Ÿå°±æ˜¯è¯´ æˆ‘ä»¬çš„CustomList1 ç±»æ˜¯æˆ‘ä»¬è‡ªå®ç°çš„ <strong>å¯è¿­ä»£çš„å®¹å™¨ç±»</strong>, <code>arr1</code> æ˜¯ä¸ªå®¹å™¨, åœ¨ä¸¤æ¬¡<code>iter(arr1)</code>æ—¶å€™, <code>obj1 =  iter(arr1)</code>, <code>obj2 =  iter(arr1)</code>, <code>obj1</code> å’Œ <code>obj2</code>æ˜¯<strong>ä¸ç›¸ç­‰çš„</strong>.</p>
<p>æˆ‘ä»¬å¯ä»¥åè¿‡æ¥æ€è€ƒä¸‹, åœ¨ä»‹ç»è¿­ä»£å™¨åè®®æ—¶å€™ ä¸¾ä¾‹çš„é‚£ä¸ªCustomList1ç±», å¦‚æœæ˜¯é‚£ä¸ª <code>arr1</code> å¯¹è±¡, åœ¨ä¸¤æ¬¡<code>iter(arr1)</code>æ—¶å€™, <code>obj1 =  iter(arr1)</code>, <code>obj2 =  iter(arr1)</code>, <code>obj1</code> å’Œ <code>obj2</code><strong>å¿…ç„¶æ˜¯ç›¸ç­‰çš„</strong>, å› ä¸ºåœ¨__iter__()ä¸­è¿”å›çš„self. éƒ½æ˜¯arr1æœ¬èº«. <strong>æ‰€ä»¥è¿™æ—¶å€™arr1æ˜¯è¿­ä»£å™¨,ä¸æ˜¯å®¹å™¨</strong>. è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯¹arr1 è¿›è¡Œä¸¤æ¬¡éå†. æƒ³è¦é‡æ–°è·å–ä¸€éé‡Œé¢çš„æ•°æ®é™¤éå†ç”Ÿæˆä¸€ä¸ªç±»ä¼¼<code>arr1</code> çš„<code>arr2</code>. <code>arr2 = CustomList1()</code>.</p>
<p>å¯¹æ¯”ä¸‹:</p>
<blockquote>
<pre><code>å¦‚æœæˆ‘ä»¬åœ¨\_\_iter\_\_() è¿”å›çš„æ˜¯ self, é‚£ä¹ˆè¿™ä¸ªç±»çš„å¯¹è±¡å°±æ˜¯ è¿­ä»£å™¨å¯¹è±¡, è€Œä¸æ˜¯å®¹å™¨å¯¹è±¡. å¦‚æœè¿”å›çš„æ˜¯ç³»ç»Ÿçš„å®¹å™¨å¯¹è±¡çš„è¿­ä»£å™¨å¦‚`iter(self._range)` æˆ–è€… ç”¨yieldçš„æ–¹å¼è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨é‚£ä¹ˆ, è¿™ä¸ªç±»çš„å¯¹è±¡å°±æ˜¯ å®¹å™¨å¯¹è±¡.

å®¹å™¨å¯¹è±¡å¦‚æœæƒ³é‡æ–°è·å–ä¸€éé‡Œé¢çš„å€¼, åªéœ€è¦è·å–ä¸€ä¸ªæ–°çš„ è¿­ä»£å™¨å¯¹è±¡, `obj1 = iter(arr1)`, å°±èƒ½é€šè¿‡è¿­ä»£`obj1`çš„éå†é‡æ–°è·å–. è¿­ä»£å™¨å¯¹è±¡è‡ªèº«æ˜¯æ— æ³•å†é‡æ–°è·å–çš„, åªèƒ½é€šè¿‡å†åˆ›å»ºä¸€ä¸ª å½“å‰è¿­ä»£å™¨å¯¹è±¡çš„å…„å¼Ÿå¯¹è±¡ `arr2 = CustomList1(), obj1 = iter(arr12)`  ç„¶åé€šè¿‡obj1é‡æ–°è·å–.
</code></pre></blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¯è¿­ä»£å¯¹è±¡-iterable&quot;&gt;&lt;a href=&quot;#å¯è¿­ä»£å¯¹è±¡-iterable&quot; class=&quot;headerlink&quot; title=&quot;å¯è¿­ä»£å¯¹è±¡(iterable)&quot;&gt;&lt;/a&gt;å¯è¿­ä»£å¯¹è±¡(iterable)&lt;/h2&gt;&lt;p&gt;å¸¸è§çš„å¯è¿­ä»£å¯¹è±¡æ¯”å¦‚ list, set
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>runtimeåœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨(äºŒ)-è‡ªå®šä¹‰KVO</title>
    <link href="http://yoursite.com/2017/06/12/runtime%E5%9C%A8%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8-%E4%BA%8C-%E8%87%AA%E5%AE%9A%E4%B9%89KVO/"/>
    <id>http://yoursite.com/2017/06/12/runtimeåœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨-äºŒ-è‡ªå®šä¹‰KVO/</id>
    <published>2017-06-12T10:01:30.000Z</published>
    <updated>2017-06-14T01:50:47.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="KVOçš„åŸç†"><a href="#KVOçš„åŸç†" class="headerlink" title="KVOçš„åŸç†"></a>KVOçš„åŸç†</h2><p>KVOè§‚å¯Ÿè€…æ¨¡å¼, æŒ‡å®šå¯¹è±¡çš„å±æ€§è¢«ä¿®æ”¹å, KVOå°±ä¼šè‡ªåŠ¨é€šçŸ¥ç›¸åº”çš„è§‚å¯Ÿè€…. åœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨æ­¥éª¤å¯ä»¥å½’çº³ä¸ºä¸‰æ­¥:</p>
<ol>
<li><p>æ³¨å†Œéœ€è¦è§‚å¯Ÿçš„å¯¹è±¡çš„å±æ€§<br><code>- (void)addObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options context:(nullable void *)context;</code></p>
</li>
<li><p>å®ç°å›è°ƒæ–¹æ³•, å½“ç›‘æµ‹çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶å€™ä¼šå›è°ƒè¯¥æ–¹æ³•.<br><code>- (void)observeValueForKeyPath:(nullable NSString *)keyPath ofObject:(nullable id)object change:(nullable NSDictionary&lt;NSKeyValueChangeKey, id&gt; *)change context:(nullable void *)context;</code></p>
</li>
<li><p>å–æ¶ˆæ³¨å†Œè§‚å¯Ÿè€….<br><code>- (void)removeObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath context:(nullable void *)context</code></p>
</li>
</ol>
<p>åŸºæœ¬çš„ä½¿ç”¨æ–¹æ³•ä¸ç”¨å¤šè¯´äº†. ç›´æ¥æ¥ä»‹ç»è‹¹æœçš„å®ç°åŸç†ä»¥åŠè‡ªå®ç°çš„æ­¥éª¤.</p>
<h2 id="è‹¹æœå®ç°åŸç†"><a href="#è‹¹æœå®ç°åŸç†" class="headerlink" title="è‹¹æœå®ç°åŸç†"></a>è‹¹æœå®ç°åŸç†</h2><p>å½“ä½ æ³¨å†Œè§‚å¯Ÿä¸€ä¸ªå¯¹è±¡æ—¶å€™, ä¸€ä¸ªæ–°çš„ç»§æ‰¿äºä½ è§‚å¯Ÿçš„ç±»è¢«åŠ¨æ€åˆ›å»º, å¹¶ä¸”é‡å†™setteræ–¹æ³•. ç„¶åä¼šæŠŠè¿™ä¸ªå¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘æ–°åˆ›å»ºçš„ç±», è¿™ä¸ªæ—¶å€™å¦‚æœå†æ”¹å˜å…¶å±æ€§å°±ä¼šè°ƒç”¨åˆšåˆšåˆ›å»ºç±»çš„setteræ–¹æ³•äº†. è¿™æ—¶å€™å†åœ¨setteræ–¹æ³•ä¸­å­˜å‚¨å±æ€§çš„å€¼å’Œè°ƒç”¨å›è°ƒçš„æ–¹æ³•.</p>
<pre><code>- (void)YYKVO_addObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options context:(void *)context
{
    // è·å–setteræ–¹æ³•
    SEL setterSelector = NSSelectorFromString(setterForGetter(keyPath));
    Method setterMethod = class_getInstanceMethod([self class], setterSelector);
    if (!setterMethod) {
        NSLog(@&quot;æ²¡æœ‰æ‰¾åˆ°setæ–¹æ³•, å¯èƒ½æ²¡æœ‰è¯¥å±æ€§, æ— æ³•ç»‘å®š&quot;);
        return;
    }

    // ç»„å»ºéœ€è¦åŠ¨æ€åˆ›å»ºå­ç±»çš„ç±»å
    NSString *oldClassName = NSStringFromClass([self class]);
    NSString *newName = [@&quot;YY&quot; stringByAppendingString:oldClassName];
    const char *newClassName = [newName UTF8String];

    // æ·»åŠ ä¸€ä¸ªç±»
    Class newClass = objc_allocateClassPair([self class], newClassName, 0);
    objc_registerClassPair(newClass);

    // ä¸ºæ–°åˆ›å»ºçš„ç±» æ·»åŠ setteræ–¹æ³•
    class_addMethod(newClass, setterSelector, (IMP)YYKVO_setter_super, &quot;v@:@&quot;);

    // æ”¹å˜selfçš„isaæŒ‡é’ˆ, æŒ‡å‘åˆ›å»ºçš„å­ç±»
    object_setClass(self, newClass);

    // å…³è”observe å’Œ self, ç”¨äºåœ¨å›è°ƒæ–¹æ³•ä½¿ç”¨
    objc_setAssociatedObject(self, (__bridge const void *)@&quot;YYKOVObserver&quot;, observer, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}
</code></pre><blockquote>
<ol>
<li>ç»„å»ºsetæ–¹æ³•çš„åç§°, ç„¶åè·å–å…¶setteræ–¹æ³•, å¦‚æœä¼ å…¥çš„keyPathå‡ºé”™, æ²¡æœ‰è¯¥å±æ€§, é‚£ä¹ˆåé¢çš„å†…å®¹å°±ä¸å¿…è¦å­˜åœ¨.</li>
<li>åŠ¨æ€åˆ›å»ºå­ç±», æ–°çš„å­ç±»ç»§æ‰¿å½“å‰ç±»<code>Class newClass = objc_allocateClassPair([self class], newClassName, 0);</code>, æ³¨å†Œæ–°ç±»è®©ç³»ç»ŸçŸ¥é“.</li>
<li>é‡å†™setteræ–¹æ³•, ä¸ºæ–°çš„ç±»æ·»åŠ setteræ–¹æ³•.<br>`BOOL class_addMethod(Class cls, SEL name, IMP imp, <pre><code>const char *types)`                             
</code></pre><ol>
<li>Class cls :  æŒ‡å®šç±», ä¸ºæˆ‘ä»¬çš„æ–°åˆ›å»ºçš„ç±»newClass</li>
<li>SEL name :  æ–¹æ³•åç§°.</li>
<li>IMP imp :  å‡½æ•°æŒ‡é’ˆ. </li>
<li>è®¾ç½®è¿”å›å€¼å’Œå‚æ•°. è‹¹æœçš„è¯´æ˜: An array of characters that describe the types of the arguments to the method. For possible values, see Objective-C Runtime Programming Guide &gt; <a href="xcdoc://?url=developer.apple.com/library/etc/redirect/xcode/content/1189/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtTypeEncodings.html#//apple_ref/doc/uid/TP40008048-CH100" target="_blank" rel="external">Type Encodings</a>. Since the function must take at least two argumentsâ€”self and _cmd, the second and third characters must be â€œ@:â€ (the first character is the return type). è‹¹æœæ–‡æ¡£ä¸­æœ‰ä»½è¡¨æ ¼è¯´æ˜äº†ä¸åŒç¬¦å·çš„æ„ä¹‰. æ¯”å¦‚è¿™é‡Œçš„:<ol>
<li>V: A void è¡¨ç¤ºè¿”å›ä¸ºç©º;</li>
<li>@: An object (whether statically typed or typed id) è¿™é‡Œä¼ å…¥çš„å°±æ˜¯self,</li>
<li>: è¡¨ç¤ºA method selector (SEL),ä¹Ÿå°±æ˜¯_cmd.</li>
<li>@ æœ‰è¡¨ç¤ºidç±»å‹.</li>
</ol>
</li>
</ol>
</li>
</ol>
</blockquote>
<pre><code>è¿™é‡Œè¯´æ˜ä¸‹, æ–¹æ³•åç§°(SEL name) å’Œ å‡½æ•°æŒ‡é’ˆ(IMP imp) æŒ‡å‘çš„å‡½æ•°åä¸å¿…ä¸€è‡´, å¾ˆæ˜æ˜¾å¦‚æœè¦æ±‚ä¸€è‡´å°±ä¸ä¼šéœ€è¦ä¸¤ä¸ªå‚æ•°äº†. 
</code></pre><p>  æ¥ä¸‹æ¥å°±æ˜¯å®ç° <code>YYKVO_setter_super</code>å‡½æ•°, è¿™é‡Œæˆ‘å†™äº†ä¸¤ä¸ªç±»ä¼¼çš„å‡½æ•°, åŒºåˆ«æ˜¯ä¸€ä¸ªç›´æ¥è°ƒç”¨<code>objc_msgSendSuper()</code>å‡½æ•°, ä¸€ä¸ªç”¨<code>objc_msgSend()</code>å…ˆçœ‹<code>YYKVO_setter</code></p>
<pre><code>void YYKVO_setter (id self, SEL _cmd, id newValue)
{
    id class = [self class];
    // æ”¹å˜selfçš„isaæŒ‡å‘super
    object_setClass(self, class_getSuperclass([self class]));

       // è·å–åˆ°æ›´æ”¹å‰å±æ€§çš„å€¼
    NSString *setterName = NSStringFromSelector(_cmd);
    NSString *getName = getterForSetter(setterName);
    id oldValue = [self valueForKey:getName];

    // æ›´è¯¥å±æ€§çš„å€¼
    SEL setSelector = NSSelectorFromString(setterName);
    objc_msgSend(self, setSelector, newValue);

    // è°ƒç”¨å›è°ƒæ–¹æ³•
    id observer = objc_getAssociatedObject(self, (__bridge const void *)@&quot;YYKOVObserver&quot;);
    objc_msgSend(observer, @selector(observeValueForKeyPath:ofObject:change:context:), self, @&quot;name&quot;, @{@&quot;oldValue&quot; : oldValue, @&quot;newValue&quot; : newValue}, nil);

    // æ›´æ”¹selfçš„isaæŒ‡å‘æ–°åˆ›å»ºçš„å­ç±»
    object_setClass(self, class);
}
</code></pre><blockquote>
<p>æ”¹å˜selfçš„isaæŒ‡å‘çˆ¶ç±», æ‰€ä»¥è¿™æ—¶å€™selfå°±å˜æˆäº†æˆ‘ä»¬æŒ‡å®šç›‘æµ‹çš„ç±»äº†. æœ€åå†æ¢å›æ¥<code>object_setClass(self, class);</code>ä¸ç„¶selfçš„æŒ‡é’ˆè¿˜æ˜¯æŒ‡å‘çˆ¶ç±», å½“ä¸‹æ¬¡å±æ€§åœ¨å‘ç”Ÿæ”¹å˜æ—¶å€™, å°±ä¸ä¼šè°ƒç”¨æˆ‘ä»¬æŒ‡å®šçš„setteræ–¹æ³•äº†.</p>
</blockquote>
<pre><code>void YYKVO_setter_super (id self, SEL _cmd, id newValue)
{
    NSString *setterName = NSStringFromSelector(_cmd);
    NSString *getName = getterForSetter(setterName);

    id oldValue = [self valueForKey:getName];

    struct objc_super superClass = {

        .receiver = self,
        .super_class = class_getSuperclass([self class])
    };
    objc_msgSendSuper(&amp;superClass, _cmd, newValue);

    id observer = objc_getAssociatedObject(self, (__bridge const void *)@&quot;YYKOVObserver&quot;);
    objc_msgSend(observer, @selector(observeValueForKeyPath:ofObject:change:context:), self , @&quot;name&quot;, @{@&quot;oldValue&quot; : oldValue, @&quot;newValue&quot; : newValue}, nil);
}
</code></pre><blockquote>
<p>æ²¡æœ‰å»æ”¹å˜selfçš„isaæŒ‡é’ˆ, è€Œæ˜¯ç›´æ¥ä½¿ç”¨äº†<code>objc_msgSendSuper()</code>å‡½æ•°, è¿™ä¸ªå‡½æ•°éœ€è¦ä¼ å…¥ä¸€ä¸ªç»“æ„ä½“å°±æ˜¯æˆ‘ä»¬ç»„å»ºçš„superClassç»“æ„ä½“. <code>objc_super</code> : Specifies the superclass of an instance. é‡Œé¢åŒ…å«ä¸¤ä¸ªå…ƒç´ :</p>
<blockquote>
<p>var receiver: Unmanaged<anyobject>!<br>    A pointer of type objc_object. Specifies an instance of a class.</anyobject></p>
<p>var super_class: AnyClass!<br>    A pointer to a Class data structure. Specifies the particular superclass of the instance to message.</p>
</blockquote>
<p>åœ¨æœ€åè°ƒç”¨å›è°ƒæ–¹æ³•æ—¶å€™, ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜selfè¿™ä¸ªæ—¶å€™è¿˜æ˜¯æŒ‡å‘æˆ‘ä»¬åˆ›å»ºçš„å­ç±»çš„.</p>
</blockquote>
<p>æœ‰ä¸ªå¾ˆæœ‰æ„æ€çš„åœ°æ–¹, æˆ‘åœ¨è°ƒç”¨å›è°ƒæ–¹æ³•æ—¶å€™, å¹¶æ²¡æœ‰åˆ¤æ–­observeræ˜¯ä¸æ˜¯å®ç°äº†<code>@selector(observeValueForKeyPath:ofObject:change:context:)</code> å¦‚æœæ²¡æœ‰å®ç°, è¿™æ ·è°ƒç”¨å°±ä¼šcrash. å…¶å®æˆ‘æƒ³è¿‡é€šè¿‡åˆ¤æ–­ä¿®æ”¹æˆè¿™æ ·:</p>
<pre><code>Method observeValueForKeyPathMethod = class_getInstanceMethod([observer class], @selector(observeValueForKeyPath:ofObject:change:context:));
if (observeValueForKeyPathMethod) {
        objc_msgSend(observer, @selector(observeValueForKeyPath:ofObject:change:context:), self , getName, @{@&quot;oldValue&quot; : oldValue, @&quot;newValue&quot; : newName}, nil);
    }
</code></pre><p>ä½†æ˜¯ifçš„åˆ¤æ–­ä¸ºçœŸ, åˆ°è¿™é‡Œæ„Ÿè§‰æ— æ³•è¿›è¡Œä¸‹å»äº†, æ‰€ä»¥å»æµ‹è¯•ä¸‹è‹¹æœåŸç”Ÿçš„çœ‹ä»–æ˜¯å¦å­˜åœ¨è¿™ä¸ªé—®é¢˜. å»æµ‹è¯•äº†ä¸‹, å¦‚æœæ·»åŠ äº†è§‚å¯Ÿè€…, ä½†æ˜¯observeråœ¨æ²¡æœ‰å®ç°å›è°ƒæ–¹æ³•çš„æƒ…å†µä¸‹ä¸€æ ·ä¼šcrash. æŸ¥äº†æ·»åŠ è§‚å¯Ÿè€…æ–¹æ³•ä¸­çš„è¯´æ˜, åœ¨è¯´æ˜observeræ—¶å€™æŒ‡å‡º</p>
<blockquote>
<p>observer :</p>
<blockquote>
<pre><code>The object to register for KVO notifications. The observer **must implement the key-value     observing method observeValueForKeyPath:ofObject:change:context:**.
</code></pre></blockquote>
</blockquote>
<p>æ‰€ä»¥, è¯´æ˜è‹¹æœåŸç”Ÿçš„ä¹Ÿæ²¡èƒ½è§£å†³è¿™ä¸ªé—®é¢˜(å½“å­˜åœ¨ç»§æ‰¿å…³ç³»æ—¶å€™, æ— æ³•åˆ¤æ–­åˆ°åº•æ˜¯é‚£ä¸ªç±»å®ç°äº†è¯¥æ–¹æ³•), æˆ‘ä»¬å¤§æ¦‚èƒ½å¤ŸçŒœæµ‹åœ¨NSObjectç±»ä¸­æœ‰è¿™æ ·çš„å®ç°. </p>
<pre><code>- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context
{
    NSlog(@&quot; å­ç±»å¿…é¡»å®ç°&quot;);
    crash!!!;
}
</code></pre><blockquote>
<p>å°±æ˜¯è¿™ä¸ªæ„æ€å•Š, è‚¯å®šè‹¹æœè¿˜å¹²äº†å¾ˆå¤šåˆ«çš„äº‹. </p>
</blockquote>
<p>æœ‰ä¸¤ä¸ªå‡½æ•°<code>setterForGetter()</code> å’Œ <code>getterForSetter()</code> æˆ‘ç”¨äº†ç¡¬ç¼–ç çš„æ–¹å¼å®ç°äº†, è‚¯å®šæ˜¯èƒ½ä¼˜åŒ–çš„. åœ¨æœ€åæˆ‘ä¼šå†™å‡ºæ¥. </p>
<h2 id="ç”¨blockçš„æ–¹å¼"><a href="#ç”¨blockçš„æ–¹å¼" class="headerlink" title="ç”¨blockçš„æ–¹å¼:"></a>ç”¨blockçš„æ–¹å¼:</h2><p>å…¶å®åŸç†å¾ˆç®€å•, ä¸Šé¢æˆ‘ä»¬å…³è”äº†ä¸€ä¸ªå¯¹è±¡observer, ç°åœ¨æˆ‘ä»¬observer å’Œ ä¼ å…¥çš„blockä¸€èµ·å…³è”ä¿å­˜ä¸‹æ¥, åœ¨setteræ–¹æ³•ä¸­è°ƒç”¨block.</p>
<pre><code>- (void)YYKVO_addObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath withBlock:(YYObserverBlock)block
{
    SEL setterSelector = NSSelectorFromString(setterForGetter(keyPath));
    Method setterMethod = class_getInstanceMethod([self class], setterSelector);
    if (!setterMethod) {
        NSLog(@&quot;æ²¡æœ‰æ‰¾åˆ°setæ–¹æ³•, æ‰€ä»¥å¯èƒ½æ²¡æœ‰è¯¥å±æ€§, æ— æ³•ç»‘å®š&quot;);
        return;
    }
    NSString *oldClassName = NSStringFromClass([self class]);
    NSString *newName = [@&quot;YY&quot; stringByAppendingString:oldClassName];
    const char *newClassName = [newName UTF8String];

    Class newClass = objc_allocateClassPair([self class], newClassName, 0);
    objc_registerClassPair(newClass);

    class_addMethod(newClass, setterSelector, (IMP)YYKVO_setter_block, &quot;v@:@&quot;);
    object_setClass(self, newClass);

    NSDictionary *infoDic = @{@&quot;YYKOVObserver&quot; : observer, @&quot;block&quot;: block};
    objc_setAssociatedObject(self, (__bridge const void *)@&quot;YYKVOInfo&quot;, infoDic, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}

void YYKVO_setter_block(id self, SEL _cmd, id newValue)
{
    NSString *setterName = NSStringFromSelector(_cmd);
    NSString *getName = getterForSetter(setterName);

    id oldValue = [self valueForKey:getName];

    struct objc_super superClass = {

        .receiver = self,
        .super_class = class_getSuperclass([self class])
    };
    objc_msgSendSuper(&amp;superClass, _cmd, newValue);

    id infoDic = objc_getAssociatedObject(self, (__bridge const void *)@&quot;YYKVOInfo&quot;);
    id observer = [(NSDictionary *)infoDic objectForKey: @&quot;YYKOVObserver&quot;];
    YYObserverBlock block = [(NSDictionary *)infoDic objectForKey: @&quot;block&quot;];
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        if (block) {
            block(observer, getName, oldValue, newValue);
        }
    });
}
</code></pre><blockquote>
<p>ä»£ç ä¸­å­˜åœ¨ä¸€äº›ç¡¬ç¼–ç , ä¸»è¦é€»è¾‘å°±æ˜¯åœ¨æ·»åŠ è§‚å¯Ÿçš„æ–¹æ³•ä¸­, æŠŠblockå’Œblockéœ€è¦çš„å‚æ•°å…ˆå…³è”ä¿å­˜èµ·æ¥, åœ¨setteræ–¹æ³•ä¸­è°ƒç”¨block. </p>
</blockquote>
<pre><code>NSString * setterForGetter(NSString *getName)
{
    NSMutableString *setName = getName.mutableCopy;
    if ([setName hasPrefix:@&quot;get&quot;]) {
        [setName stringByReplacingOccurrencesOfString:@&quot;get&quot; withString:@&quot;&quot;];
    }
    NSString *replaceString = [NSString stringWithFormat:@&quot;set%@&quot;, [[setName substringWithRange:NSMakeRange(0, 1)] uppercaseString]];
    [setName replaceCharactersInRange:NSMakeRange(0, 1) withString:replaceString];
    [setName appendString:@&quot;:&quot;];
    return setName.copy;
}

NSString * getterForSetter(NSString *setName)
{
    NSMutableString *getName = setName.mutableCopy;
    if ([getName hasPrefix:@&quot;set&quot;]) {
        [getName deleteCharactersInRange:NSMakeRange(0, 3)];
    }
    if ([getName containsString:@&quot;:&quot;]) {
        [getName deleteCharactersInRange:NSMakeRange(getName.length - 1, 1)];
    }
    NSString *replaceString =  [[getName substringWithRange:NSMakeRange(0, 1)] lowercaseString];
    [getName replaceCharactersInRange:NSMakeRange(0, 1) withString:replaceString ];
    return getName.copy;
}
</code></pre><blockquote>
<p>è¿™ä¸¤ä¸ªæ–¹æ³•åªæ˜¯ä¸ºäº†å®Œæˆè¿™ä¸ªåŠŸèƒ½, æ‹¼å‡ºset å’Œ getçš„æ–¹æ³•å, é‡Œé¢æœ‰ä¸€äº›ç¡¬ç¼–ç çš„åœ°æ–¹åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ—¶å€™éœ€è¦è°ƒæ•´.</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;KVOçš„åŸç†&quot;&gt;&lt;a href=&quot;#KVOçš„åŸç†&quot; class=&quot;headerlink&quot; title=&quot;KVOçš„åŸç†&quot;&gt;&lt;/a&gt;KVOçš„åŸç†&lt;/h2&gt;&lt;p&gt;KVOè§‚å¯Ÿè€…æ¨¡å¼, æŒ‡å®šå¯¹è±¡çš„å±æ€§è¢«ä¿®æ”¹å, KVOå°±ä¼šè‡ªåŠ¨é€šçŸ¥ç›¸åº”çš„è§‚å¯Ÿè€…. åœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨æ­¥éª¤å¯ä»¥å½’çº³ä¸º
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>runtimeåœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨(ä¸€)</title>
    <link href="http://yoursite.com/2017/06/08/runtime%E5%9C%A8%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8(%E4%B8%80)/"/>
    <id>http://yoursite.com/2017/06/08/runtimeåœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨(ä¸€)/</id>
    <published>2017-06-08T08:00:33.000Z</published>
    <updated>2017-06-12T09:59:46.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å®ç°NSCodingåè®®æ–¹æ³•"><a href="#å®ç°NSCodingåè®®æ–¹æ³•" class="headerlink" title="å®ç°NSCodingåè®®æ–¹æ³•"></a>å®ç°NSCodingåè®®æ–¹æ³•</h2><blockquote>
<p>åœ¨å½’æ¡£è‡ªå®šä¹‰çš„å¯¹è±¡æ—¶å€™, éœ€è¦è‡ªå·±å®ç°NSCodingåè®®, è¯¥åè®®æœ‰ä¸¤ä¸ªæ–¹æ³•éœ€è¦å®ç°:</p>
</blockquote>
<pre><code>@protocol NSCoding
- (void)encodeWithCoder:(NSCoder *)aCoder;
- (nullable instancetype)initWithCoder:(NSCoder *)aDecoder; // NS_DESIGNATED_INITIALIZER
@end
</code></pre><p>  é»˜è®¤ä¸º<code>@required</code> çš„, é€šå¸¸æˆ‘ä»¬çš„åŠæ³•æ˜¯å»æ¯ä¸ªå±æ€§éƒ½å»å†™ä¸€é, æ¯”å¦‚è¿™æ ·:</p>
<pre><code>- (void)encodeWithCoder:(NSCoder *)aCoder
{
    [aCoder encodeObject:self.name forKey:@&quot;name&quot;];
    [aCoder encodeObject:self.ID forKey:@&quot;ID&quot;];
}    

- (id)initWithCoder:(NSCoder *)aDecoder
{
   if (self = [super init]) {
       self.name = [aDecoder decodeObjectForKey:@&quot;name&quot;];
       self.ID= [aDecoder decodeObjectForKey:@&quot;ID&quot;];
    }
   return self;
}
</code></pre><blockquote>
<p>å½“å±æ€§å¾ˆå¤šåå†™èµ·æ¥ä¼šå¾ˆç¹ç, è€Œä¸”å½“æˆ‘ä»¬æ”¹äº†å±æ€§çš„å®šä¹‰å, æ–¹æ³•ä¸­çš„å®ç°ä¹Ÿè¦è·Ÿç€æ”¹, è™½è¯´ä¸æ˜¯ä»€ä¹ˆéš¾äº‹, ä½†æ˜¯è¿™æ ·é‡å¤è€Œä¸”æ— èŠçš„å·¥ä½œå®åœ¨æ— è¶£. è¿™é‡Œå¼•å‡ºäº†ä½¿ç”¨runtimeè¾¾åˆ°ä¸€åŠ³æ°¸é€¸çš„åŠæ³•.</p>
</blockquote>
<p><strong>åŸç†å°±æ˜¯åœ¨è¿è¡Œæ—¶é€šè¿‡è·å–è¯¥ç±»çš„æ‰€æœ‰å±æ€§åç§°, ç„¶åé€šè¿‡KVCè·å–åˆ°è¯¥å±æ€§å˜é‡çš„å€¼, ç„¶åè°ƒç”¨<code>- (void)encodeObject:(nullable id)objv forKey:(NSString *)key;</code> å’Œ <code>- (nullable id)decodeObjectForKey:(NSString *)key;</code>è¾¾åˆ°åŒæ ·çš„æ•ˆæœ</strong></p>
<blockquote>
<p>å®ç°çš„ä»£ç å¦‚ä¸‹:</p>
</blockquote>
<pre><code>- (void)encodeWithCoder:(NSCoder *)aCoder
{
    unsigned int outCount = 0;
    Ivar *ivars = class_copyIvarList([self class], &amp;outCount);
    for (int i = 0; i &lt; outCount; i ++) {
        Ivar ivar = ivars[i];
        const char *propertyName = ivar_getName(ivar);
        NSString *propertyNameString = [NSString stringWithUTF8String:propertyName];
        id value = [self valueForKey:propertyNameString];
        [aCoder encodeObject:value forKey:propertyNameString];
    }
}

- (nullable instancetype)initWithCoder:(NSCoder *)aDecoder
{
    if (self = [super init]) {
        unsigned int outCount = 0;
        Ivar *ivars = class_copyIvarList([self class], &amp;outCount);
        for (int i = 0; i &lt; outCount; i ++) {
            Ivar ivar = ivars[i];
            const char *propertyName = ivar_getName(ivar);
            NSString *propertyNameString = [NSString stringWithUTF8String:propertyName];
            id value = [aDecoder decodeObjectForKey:propertyNameString];
            [self setValue:value forKey:propertyNameString];
        }
    }
    return self;
}
</code></pre><blockquote>
<p>è¦ä½¿ç”¨è¿è¡Œæ—¶çš„å‡½æ•°éœ€è¦å¯¼å…¥å¤´æ–‡ä»¶<code>#import &lt;objc/message.h&gt;</code><br><code>Ivar *ivars = class_copyIvarList([self class], &amp;outCount);</code> è·å–è¯¥ç±»çš„å±æ€§çš„åˆ—è¡¨, outCountè®°å½•äº†ä¸€ä¸ªæœ‰å¤šå°‘ä¸ªå±æ€§. æ‰€ä»¥ä¸‹é¢forå¾ªç¯å°±æ˜¯éå†æ¯ä¸ªå±æ€§.</p>
</blockquote>
<p>åœ¨è®²åˆ°<code>ivar_getName()</code> å‡½æ•°å‰,å¯ä»¥å…ˆçœ‹ä¸‹Ivar çš„å®šä¹‰</p>
<pre><code>typedef struct objc_ivar *Ivar;

struct objc_ivar {
    char *ivar_name                                          OBJC2_UNAVAILABLE;
    char *ivar_type                                          OBJC2_UNAVAILABLE;
    int ivar_offset                                          OBJC2_UNAVAILABLE;
#ifdef __LP64__
    int space                                                OBJC2_UNAVAILABLE;
#endif
}                                                            OBJC2_UNAVAILABLE;
</code></pre><p>ä¸€ä¸ªIvarçš„ç»“æ„ä½“ä¸­ä¿å­˜ç€<em>å˜é‡åç§°</em> ã€å˜é‡ç±»å‹ã€åç§»é‡. æˆ‘ä»¬åœ¨æ„çš„å°±æ˜¯éœ€è¦è·å–åˆ°åå­—ï¼Œruntimeç»™æˆ‘ä»¬æä¾›äº†<code>ivar_getName()</code>å‡½æ•°å¯ä»¥è·å–åˆ°.</p>
<p>ç„¶åé€šè¿‡KVCè·å–åˆ°å±æ€§å˜é‡çš„å€¼,<br><code>id value = [self valueForKey:propertyNameString];</code> </p>
<p><strong>é€šè¿‡æµ‹è¯•å½“å±æ€§ä¸º<code>NSInteger</code> æˆ–è€… <code>int</code> ç±»å‹æ—¶å€™ä¸€æ ·èƒ½ä½¿ç”¨, æš‚æ—¶æ²¡æœ‰å‘ç°è¿™æ ·ä½¿ç”¨å­˜åœ¨çš„é—®é¢˜</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å®ç°NSCodingåè®®æ–¹æ³•&quot;&gt;&lt;a href=&quot;#å®ç°NSCodingåè®®æ–¹æ³•&quot; class=&quot;headerlink&quot; title=&quot;å®ç°NSCodingåè®®æ–¹æ³•&quot;&gt;&lt;/a&gt;å®ç°NSCodingåè®®æ–¹æ³•&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;åœ¨å½’æ¡£è‡ªå®šä¹‰çš„å¯¹è±¡
    
    </summary>
    
    
      <category term="1" scheme="http://yoursite.com/tags/1/"/>
    
  </entry>
  
  <entry>
    <title>Manacherç®—æ³•</title>
    <link href="http://yoursite.com/2017/04/10/Manacher/"/>
    <id>http://yoursite.com/2017/04/10/Manacher/</id>
    <published>2017-04-10T07:31:28.000Z</published>
    <updated>2017-10-26T02:07:15.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ±‚æœ€é•¿å›æ–‡é•¿åº¦"><a href="#æ±‚æœ€é•¿å›æ–‡é•¿åº¦" class="headerlink" title="æ±‚æœ€é•¿å›æ–‡é•¿åº¦"></a>æ±‚æœ€é•¿å›æ–‡é•¿åº¦</h1><h2 id="å›æ–‡çš„å®šä¹‰"><a href="#å›æ–‡çš„å®šä¹‰" class="headerlink" title="å›æ–‡çš„å®šä¹‰:"></a>å›æ–‡çš„å®šä¹‰:</h2><ul>
<li><strong>aba; abba; ç±»ä¼¼è¿™ç§éƒ½ç®—æ˜¯å›æ–‡.</strong></li>
</ul>
<h2 id="å›æ–‡æœ€å¤§é•¿åº¦"><a href="#å›æ–‡æœ€å¤§é•¿åº¦" class="headerlink" title="å›æ–‡æœ€å¤§é•¿åº¦:"></a>å›æ–‡æœ€å¤§é•¿åº¦:</h2><ul>
<li><strong>aba æœ€å¤§å›æ–‡é•¿åº¦ä¸º3</strong> </li>
<li><strong>abba æœ€å¤§å›æ–‡çš„é•¿åº¦ä¸º4</strong></li>
<li><strong>abacaba æœ€å¤§å›æ–‡é•¿åº¦ä¸º7</strong> </li>
</ul>
<h1 id="Manacher"><a href="#Manacher" class="headerlink" title="Manacher "></a>Manacher </h1><h2 id="å›æ–‡åŠå¾„"><a href="#å›æ–‡åŠå¾„" class="headerlink" title="å›æ–‡åŠå¾„:"></a>å›æ–‡åŠå¾„:</h2><blockquote>
<p>aba ä»¥aä¸ºä¸­å¿ƒæ—¶å€™, å›æ–‡åŠå¾„ä¸º1,åªæœ‰aä¸€ä¸ª; bä¸ºä¸­å¿ƒæ—¶å€™å›æ–‡åŠå¾„ä¸º2;<br>å› ä¸ºæœ‰äº›å›æ–‡æ˜¯abbaè¿™ç§, ä¸ºäº†è§£å†³å¥‡å¶ä¸ç¡®å®šæ€§, æˆ‘ä»¬åœ¨æ‰€æœ‰å­—ç¬¦çš„é—´æ’å…¥ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦<strong>#</strong></p>
<blockquote>
<p>abba -&gt; #a#b#b#a#</p>
</blockquote>
<p><strong>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ¥çœ‹æ¯ä½çš„RL</strong></p>
<blockquote>
<p>aba -&gt; # a # b # a #</p>
<p>   RL:&emsp;&emsp;1 2 1 4 1 2 1</p>
<p>RL-1:&emsp;0 1 0 3 0 1 0</p>
<p>abba -&gt; # a # b # b # a #</p>
<p>   RL: &emsp;&emsp;1 2 1 2 5 2 1 2 1</p>
<p>RL-1: &emsp;0 1 0 1 4 1 0 1 0</p>
</blockquote>
</blockquote>
<p><strong>è¿™é‡Œå¼•å…¥çš„RL-1 æ­£å¥½æ˜¯æœªæ’å…¥#æ—¶å€™çš„å›æ–‡çš„é•¿åº¦</strong>, æ‰€ä»¥ç°åœ¨é—®é¢˜è½¬æ¢ä¸ºæ±‚RL.</p>
<p><strong>é‡å¤è®¿é—®çš„é—®é¢˜</strong></p>
<blockquote>
<p>åˆ©ç”¨å›æ–‡çš„å¯¹ç§°æ€§, å¯ä»¥å‡å°‘ä¸€äº›å­—ç¬¦ä¸²çš„å¯¹æ¯”è¿‡ç¨‹. ä¸ºäº†æ›´å¥½çš„è¯´æ˜è¿™äº›é—®é¢˜, æˆ‘ä»¬å¼•å…¥å‡ ä¸ªè¾…åŠ©å˜é‡MaxRight, è¡¨ç¤ºå½“å‰æ‰€æœ‰å›å­æ–‡ä¸²èƒ½è§¦åŠçš„æœ€å³ä¸€ä¸ªå­—ç¬¦ä½ç½®, Pos è¡¨ç¤ºMaxRightå¯¹åº”çš„ä¸­å¿ƒä½ç½®.<br><img src="http://oyerwecki.bkt.clouddn.com/Manacher-1.png" alt=""></p>
<p>å‡è®¾æˆ‘ä»¬ç°åœ¨å¼€å§‹è®¿é—®, è®¿é—®åˆ°ä½ç½®i, å› ä¸ºposä¹‹å‰çš„RLæˆ‘ä»¬éƒ½æ±‚å‡ºæ¥äº†, æ‰€ä»¥ä¸‹é¢åˆ†æä¸‰ç§æƒ…å†µ:</p>
</blockquote>
<h2 id="1-å½“iåœ¨MaxRightçš„å·¦è¾¹"><a href="#1-å½“iåœ¨MaxRightçš„å·¦è¾¹" class="headerlink" title="1. å½“iåœ¨MaxRightçš„å·¦è¾¹:"></a>1. å½“iåœ¨MaxRightçš„å·¦è¾¹:</h2><p><img src="http://oyerwecki.bkt.clouddn.com/Manacher-right.png" alt=""></p>
<blockquote>
<p>å½“æˆ‘ä»¬è¦è®¡ç®—iä½ç½®çš„RLæ—¶, æˆ‘ä»¬å…ˆå¯¹æ¯” iä½ç½®ä»¥posä¸ºä¸­ç‚¹çš„å¯¹ç§°ä½ç½®J, å‡è®¾R[j]çš„æ•´ä¸ªåŒ…å«åœ¨ MaxLeft å’Œ pos ä¹‹é—´, é‚£ä¹ˆè¯´æ˜R[i]è‡³å°‘ç­‰äºR[J], å‡å¦‚R[J]= 3, é‚£ä¹ˆiä½ç½®çš„2ä¸ªå­—ç¬¦å¯ä»¥ä¸ç”¨æ¯”è¾ƒäº†.</p>
</blockquote>
<h2 id="2-å½“iåœ¨MaxRightçš„å·¦è¾¹-ä½†æ˜¯RL-J-è¶…è¿‡MaxRightçš„å¯¹ç§°ç‚¹"><a href="#2-å½“iåœ¨MaxRightçš„å·¦è¾¹-ä½†æ˜¯RL-J-è¶…è¿‡MaxRightçš„å¯¹ç§°ç‚¹" class="headerlink" title="2. å½“iåœ¨MaxRightçš„å·¦è¾¹, ä½†æ˜¯RL[J]è¶…è¿‡MaxRightçš„å¯¹ç§°ç‚¹:"></a>2. å½“iåœ¨MaxRightçš„å·¦è¾¹, ä½†æ˜¯RL[J]è¶…è¿‡MaxRightçš„å¯¹ç§°ç‚¹:</h2><p><img src="http://oyerwecki.bkt.clouddn.com/Manacher-right-outside.png" alt=""></p>
<blockquote>
<p>å½“RL[J]è¶…è¿‡äº†MaxLeft, åªèƒ½ç¡®å®šï¼Œä¸¤æ¡è“çº¿ä¹‹é—´çš„éƒ¨åˆ†ï¼ˆå³ä¸è¶…è¿‡MaxRightçš„éƒ¨åˆ†ï¼‰æ˜¯å›æ–‡çš„. </p>
</blockquote>
<h2 id="3-å½“iåœ¨MaxRightçš„å³è¾¹"><a href="#3-å½“iåœ¨MaxRightçš„å³è¾¹" class="headerlink" title="3. å½“iåœ¨MaxRightçš„å³è¾¹:"></a>3. å½“iåœ¨MaxRightçš„å³è¾¹:</h2><p><img src="http://oyerwecki.bkt.clouddn.com/Manacher-outside.png" alt=""></p>
<blockquote>
<p>å½“è¶…è¿‡äº†maxRightä¹‹å, å°±åªèƒ½ä¸€ä¸ªä¸ªåˆ¤æ–­äº†.</p>
</blockquote>
<h1 id="æ€»ä½“çš„æ­¥éª¤"><a href="#æ€»ä½“çš„æ­¥éª¤" class="headerlink" title="æ€»ä½“çš„æ­¥éª¤:"></a>æ€»ä½“çš„æ­¥éª¤:</h1><blockquote>
<ul>
<li>åˆ¤æ–­ä½ç½®iæœ‰æ²¡æœ‰é€šè¿‡poså¯¹åº”çš„ç‚¹, å¦‚æœæ²¡æœ‰, é»˜è®¤ä¸º1, å¦‚æœæœ‰å–è¿™ä¸ªå€¼ä¸åˆ°è¾¹ç•Œå€¼ä¸­å°çš„å€¼, ä¸ºé»˜è®¤å€¼, é€šè¿‡éªŒè¯è¿™å—è‚¯å®šæ˜¯å›æ–‡.</li>
<li>ä»¥iä¸ºä¸­å¿ƒ, åˆ¤æ–­ä¸¤è¾¹æ˜¯å¦ä¸€æ ·.</li>
<li>è·Ÿæ–°pos, masRight;</li>
</ul>
</blockquote>
<p><strong><em>pythonä»£ç :</em></strong></p>
<pre><code>def manacher(s):
    #é¢„å¤„ç†
    s=&apos;#&apos;+&apos;#&apos;.join(s)+&apos;#&apos;

    RL=[0]*len(s)
    MaxRight=0
    pos=0
    MaxLen=0
    for i in range(len(s)):
        if i&lt;MaxRight:
            RL[i]=min(RL[2*pos-i], MaxRight-i)   #  i å’Œ j å…³äºposç‚¹å¯¹ç§°  RL[i] è‡³å°‘å’ŒRL[J]ä¸€æ ·   RL[J]åœ¨ä¹‹å‰å·²ç»ç®—è¿‡äº†
        #æ¯”å¦‚ *a*b*a*
        # åœ¨ç§»åŠ¨åˆ°açš„æ—¶å€™ RL[1] = 2  æ‰€ä»¥ åœ¨ç§»åŠ¨åˆ°ç¬¬äºŒä¸ªaçš„æ—¶å€™ pos = 3 bçš„ä½ç½® MaxRight = 6 æœ€åä¸€ä¸ª*ä½ç½®
        # è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥çŸ¥é“  RL[5] è‡³å°‘ç­‰äºRL[1]  å› ä¸º ä¸¤è¾¹æ˜¯å›´ç»•poså¯¹ç§°çš„
        # ä½†æ˜¯ è¿™æ˜¯åœ¨ RL[1]ä½ç½®çš„å›æ–‡æ˜¯åœ¨maxLeft(maxrightå…³äºposçš„å¯¹ç§°ç‚¹)çš„èŒƒå›´å†…çš„ å¦‚æœä¸åœ¨èŒƒå›´å†…åˆ™å¯¹æ¯” maxright-içš„èŒƒå›´ å–å°çš„éƒ¨åˆ† è¯´æ˜åˆ°è¾¹å¢ƒçš„èŒƒå›´å†…çš„éƒ½æ˜¯å¯¹ç§°çš„
        # åé¢å†æ‰©å±•æ—¶å€™ è¿™ä¸ªèŒƒå›´å†…çš„ å°±ä¸ç”¨æ¯”è¾ƒäº†
        else:
            RL[i]=1

        #å°è¯•æ‰©å±•ï¼Œæ³¨æ„å¤„ç†è¾¹ç•Œ
        while i-RL[i]&gt;=0 and i+RL[i]&lt;len(s) and s[i-RL[i]]==s[i+RL[i]]:
            RL[i]+=1
        # RL[i] è¡¨ç¤ºä»¥iä¸ºä¸­å·²ç»æŸ¥æ‰¾çš„å›æ–‡çš„åŠå¾„ è¿™ä¸ªæ—¶å€™æ—¢è¦è€ƒè™‘æ˜¯ä¸æ˜¯å°äºäº† èµ·å§‹ä½ç½® 0  i-RL[i]&gt;=0 ä¹Ÿè¦è€ƒè™‘åˆ° æ˜¯ä¸æ˜¯è¶…è¿‡äº†ç»ˆç‚¹ä½ç½® i+RL[i]&lt;len(s)
        #å¦‚æœåœ¨æœ‰æ•ˆä½ç½®å†…  åˆ¤æ–­æ–°çš„ä½ç½® å¯¹ç§°çš„å­—ç¬¦æ˜¯ä¸æ˜¯ä¸€æ ·


        # åˆ¤æ–­iä½ç½®è¾¾åˆ°çš„maxRightæ˜¯ä¸æ˜¯è¶…è¿‡äº†å½“å‰çš„maxRight å¦‚æœè¶…è¿‡äº† åˆ™æ›¿æ¢
        # è¿™é‡Œå¯ä»¥çœ‹å‡º æ›¿æ¢åposæŒ‡å‘çš„ä¸ä¸€å®šæ˜¯æœ€é•¿å›æ–‡çš„ä¸­å¿ƒç‚¹äº†
        #æ›´æ–°MaxRight,pos
        if RL[i]+i-1&gt;MaxRight:
            MaxRight=RL[i]+i-1
            pos=i
        #æ›´æ–°æœ€é•¿å›æ–‡ä¸²çš„é•¿åº¦
        MaxLen=max(MaxLen, RL[i])

    return MaxLen-1
</code></pre><p><em>å­¦ä¹ äº <a href="https://segmentfault.com/a/1190000003914228" target="_blank" rel="external">https://segmentfault.com/a/1190000003914228</a></em></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;æ±‚æœ€é•¿å›æ–‡é•¿åº¦&quot;&gt;&lt;a href=&quot;#æ±‚æœ€é•¿å›æ–‡é•¿åº¦&quot; class=&quot;headerlink&quot; title=&quot;æ±‚æœ€é•¿å›æ–‡é•¿åº¦&quot;&gt;&lt;/a&gt;æ±‚æœ€é•¿å›æ–‡é•¿åº¦&lt;/h1&gt;&lt;h2 id=&quot;å›æ–‡çš„å®šä¹‰&quot;&gt;&lt;a href=&quot;#å›æ–‡çš„å®šä¹‰&quot; class=&quot;headerlink&quot; ti
    
    </summary>
    
    
  </entry>
  
</feed>
