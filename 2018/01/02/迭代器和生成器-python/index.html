<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><meta name="author" content="æ¨é˜³"><link rel="icon" href="/header.jpg"><title>æ¬¢è¿æ‚¨ç»™æˆ‘æŒ‡å‡ºé—®é¢˜</title><meta name="description" content="å¼€å§‹å†™åšå®¢"><link rel="alternate" type="application/rss+xml" title="æ¬¢è¿æ‚¨ç»™æˆ‘æŒ‡å‡ºé—®é¢˜" href="/atom.xml"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/highlight.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">
</head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class="container-fluid"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#main-navbar" class="navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">æ¬¢è¿æ‚¨ç»™æˆ‘æŒ‡å‡ºé—®é¢˜</a></div><div id="main-navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/archives">Archive</a></li><li><a href="https://github.com/shinyYangYang">Github</a></li><li><a href="/about/">About</a></li></ul></div><div class="avatar-container"><div class="avatar-img-border"><a href="/"><img src="/header.jpg" class="avatar-img"></a></div></div></div></nav><header class="header-section"><div class="intro-header no-img"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><h1>è¿­ä»£å™¨å’Œç”Ÿæˆå™¨--python</h1><p class="post-meta">Posted on 1æœˆ 2 2018</p></div></div></div></div></div></header><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role="main" class="blog-post"><h2 id="å¯è¿­ä»£å¯¹è±¡-iterable"><a href="#å¯è¿­ä»£å¯¹è±¡-iterable" class="headerlink" title="å¯è¿­ä»£å¯¹è±¡(iterable)"></a>å¯è¿­ä»£å¯¹è±¡(iterable)</h2><p>å¸¸è§çš„å¯è¿­ä»£å¯¹è±¡æ¯”å¦‚ list, set, deque, dict, tuple ç­‰å®¹å™¨. åªè¦èƒ½è¿”å›ä¸€ä¸ª<strong>è¿­ä»£å™¨</strong>çš„å¯¹è±¡éƒ½å¯ç§°ä¸ºå¯è¿­ä»£å¯¹è±¡, è¿™é‡Œä¸€ä¸ªæ¦‚å¿µä¾èµ–äº†å¦ä¸ªæ¦‚å¿µ. ä¸¾ä¾‹è¯´æ˜ä¸‹:</p>
<pre><code>list1 = [1, 2, 3, 4, 5]
for i in list1:
    print(&apos;for in &apos;, i)

outputs:    
for in  1
for in  2
for in  3
for in  4
for in  5

# æ‰‹åŠ¨è¿­ä»£:
iterList = iter(list1) #è¿”å›çš„è¿­ä»£å™¨
try:
    while True:
        i = next(iterList) # å®ç°äº†next()æ–¹æ³•
        print(&apos;custom iter&apos;, i)

except StopIteration as e:
     print(e.value, e.args)

outputs:
custom iter 1
custom iter 2
custom iter 3
custom iter 4
custom iter 5
None ()
</code></pre><p><strong>è¯´æ˜:</strong></p>
<blockquote>
<ol>
<li>listæœ¬èº«å°±æ˜¯å¯è¿­ä»£å¯¹è±¡.</li>
<li>iter() ç”¨äºè¿”å›å¯¹è±¡çš„è¿­ä»£å™¨</li>
<li>å¯è¿­ä»£å¯¹è±¡éƒ½å®ç°äº†next()æ–¹æ³•, å½“æ²¡æœ‰å€¼å¯ä»¥è¿”å›åæŠ›å‡º <strong>StopIteration</strong> å¼‚å¸¸</li>
</ol>
</blockquote>
<p>å…³äº<code>iter()</code> å‡½æ•°, æœ‰ä¸¤ä¸ªå‚æ•°å…ˆè¯´ç¬¬ä¸€ä¸ªå‚æ•°, ä¹Ÿæ˜¯åˆ—å­ä¸­çš„å½“è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå®¹å™¨æ—¶å€™, æ¯æ¬¡éƒ½ä¼šè¿”å›è¿™ä¸ªå®¹å™¨æ–°çš„è¿­ä»£å™¨, å¦‚æœè¿™ä¸ªå‚æ•°æœ¬èº«å°±æ˜¯ä¸€ä¸ªè¿­ä»£å™¨, åˆ™ç›´æ¥è¿”å›è¿™ä¸ªè¿­ä»£å™¨. åˆ©ç”¨è¿™ç‚¹, åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯è¿­ä»£å™¨è¿˜æ˜¯å®¹å™¨, å°±ç”¨å®ƒå½“åš<code>iter()</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸¤æ¬¡è°ƒç”¨, å¦‚æœè¿”å›ä¸€æ ·, åˆ™æ˜¯è¿­ä»£å™¨.<br>ç¬¬äºŒå‚æ•°æ˜¯ è¿­ä»£åˆ°è¿™ä¸ªå€¼ååœæ­¢è¿­ä»£. <code>num = iter(random_num, 1)</code> å½“numä¸­nextå€¼ä¸º1çš„æ—¶å€™å°±æŠ›å‡º<code>StopIteration</code>å¼‚å¸¸,ç»“æŸè¿­ä»£  </p>
<p>è¿™é‡Œå¯ä»¥çœ‹å‡º list è¿™ç±»ç³»ç»Ÿçš„å®¹å™¨ç±», é»˜è®¤å®ç°äº†iter() å’Œ next() æ–¹æ³•. ä¹Ÿå°±æ˜¯ä¸‹é¢è¦è¯´çš„è¿­ä»£å™¨åè®®.<br>å¦‚æœè¦è‡ªå·±å®ç°ä¸€ä¸ªç±»ä¼¼ for in éå†, åœ¨pythonä¸­ ä¹Ÿå¯ä»¥å…ˆ è·å–è¿­ä»£å™¨ (itertor) ç„¶åå¾ªç¯å»è°ƒç”¨next() ç„¶ååˆ°æ²¡æœ‰å€¼å¾—æ—¶å€™å¤„ç†å¼‚å¸¸, é€€å‡ºå¾ªç¯.</p>
<h2 id="è¿­ä»£å™¨åè®®"><a href="#è¿­ä»£å™¨åè®®" class="headerlink" title="è¿­ä»£å™¨åè®®"></a>è¿­ä»£å™¨åè®®</h2><p>è¿­ä»£åè®®è¦æ±‚ä¸€ä¸ª <strong>__iter__()</strong>æ–¹æ³•è¿”å›ä¸€ä¸ªç‰¹æ®Šçš„è¿­ä»£å™¨å¯¹è±¡ï¼Œè¿™ä¸ªè¿­ä»£å™¨å¯¹è±¡å®ç°äº† <strong>__next__()</strong> æ–¹æ³•å¹¶é€šè¿‡ StopIteration å¼‚å¸¸æ ‡è¯†è¿­ä»£çš„å®Œæˆ.</p>
<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦è‡ªå·±ç±»æ”¯å‡ºè¿­ä»£å°±è¦éœ€è¦å®ç°ä¸‹é¢è¦æ±‚:</p>
<blockquote>
<ol>
<li>è¦å®ç°<strong>__iter__()</strong>æ–¹æ³•, å¹¶ä¸”è¿™ä¸ªæ–¹æ³•è¦è¿”å›ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡. å¦‚æœè¿™é‡Œæˆ‘ä»¬è¿”å›çš„æ˜¯ ç³»ç»Ÿå¯è¿­ä»£çš„å¯¹è±¡, æˆ‘ä»¬å°±ä¸ç”¨æ‹…å¿ƒä¸‹é¢çš„ä¸¤ç‚¹äº†, æ¯”å¦‚è¿”å›çš„æ˜¯ç±»ä¼¼ä¸Šé¢ç”¨åˆ°çš„ iterList .</li>
<li>è¿™ä¸ªè¿­ä»£å™¨å¯¹è±¡å®ç°äº†<strong>__next__()</strong>æ–¹æ³•</li>
<li>åœ¨æ²¡æœ‰å€¼çš„æ—¶å€™è¦æŠ›å‡º <strong>StopIteration</strong> å¼‚å¸¸, ç”¨æ¥è¡¨ç¤ºè¿­ä»£å·²ç»å®Œæˆäº†. è¿™ä¸ªå¼‚å¸¸æ—¶æœºæ˜¯åœ¨<strong>__next__()</strong>æ–¹æ³•ä¸­.</li>
</ol>
</blockquote>
<pre><code>class CustomList(object):

    def __init__(self):

        self._list = [1, 2, 3, 4, 5]


    def __iter__(self):

        return iter(self._list) # è¿”å›çš„æ˜¯ listçš„è¿­ä»£å™¨å¯¹è±¡, ç”±äºç³»ç»Ÿç»™listå®ç°äº† __next__() æ‰€ä»¥æˆ‘ä»¬ä¸ç”¨å¤„ç†

arr = CustomList()
for i in arr:
       print(i)

outputs:
1, 2, 3, 4, 5
</code></pre><p>è¿™é‡Œç”±äºæˆ‘ä»¬åœ¨__iter__() æ–¹æ³•ä¸­è¿”å›çš„æ˜¯ç³»ç»Ÿlistçš„è¿­ä»£å™¨, å› ä¸ºæˆ‘ä»¬çŸ¥é“listå·²ç»å®ç°äº†__next__()æ–¹æ³•, æ‰€ä»¥æˆ‘ä»¬ä¸ç”¨ç®¡.<br>è¿™é‡Œçš„åˆ—å­ä¸å¤ªåˆé€‚, å…¶å®å°±æ˜¯å¥—äº†ä¸ªå£³, é‡Œé¢è¿˜æ˜¯ç³»ç»Ÿçš„list. å¤§å®¶å°±å°†å°±ä¸‹, ä¸€æ—¶é—´æƒ³ä¸åˆ°å¥½çš„åœºæ™¯. æ¥ç€æˆ‘ä»¬æ¥è¯•è¯•åœ¨__iter__()ä¸­è¿”å›è‡ªå·±çš„å¯¹è±¡</p>
<pre><code>class CustomList1(object):

    def __init__(self):

        self._range = range(5)
        self._index = -1

    def __iter__(self):

        return self # è¿”å›çš„æ˜¯ è‡ªå®šä¹‰å¯¹è±¡, å› æ­¤æˆ‘ä»¬è¦è‡ªå·±å®ç° __next__() , å¦åˆ™ä¼šåœ¨for in æ—¶ç”±äºæ‰¾ä¸åˆ°next()æ–¹æ³•è€ŒæŠ¥é”™.

    def __next__(self):

        self._index = self._index + 1

        if self._range and self._index &lt; 5:
            return self._range[self._index]
        else:
             raise StopIteration

arr1 = CustomList1()
for i in arr1:
    print(i)


  outputs:
1, 2, 3, 4, 5
</code></pre><p>ä»£ç ä¸­çš„å‘½åä»€ä¹ˆçš„ä¸è¦å¤ªåœ¨æ„å•¦ğŸ˜…, ç›´æ¥çœ‹é‡ç‚¹, è¿™é‡Œæˆ‘ä»¬åœ¨__iter__() è¿”å›äº†self, æ„å‘³ç€selfå°±æ˜¯è¿­ä»£å™¨å¯¹è±¡, å•ç‹¬æŠ½ç¦»æ¥çœ‹ self å’Œ è¿­ä»£å™¨å¯¹è±¡å®åœ¨å¾ˆéš¾æƒ³åˆ°ä¸€å—å», å°±å› ä¸ºåœ¨__iter__() è¿”å›äº†self, ç„¶åå®ç°äº† __next__()æ–¹æ³•å°±å˜æˆäº†å¯è¿­ä»£çš„è¿­ä»£å™¨å¯¹è±¡äº†. æ‰€ä»¥ä¸‹é¢çš„è¿­ä»£å™¨æˆ‘ä»¬å…¶å®å·²ç»å¼„çš„å·®ä¸å¤šäº†.</p>
<p>ä»£ç ä¸­è™½è¯´æˆ‘ä»¬ç”¨äº† range è¿™ä¸ªç³»ç»Ÿçš„å¯è¿­ä»£å¯¹è±¡, ä½†æ˜¯æˆ‘ä»¬åœ¨è¿­ä»£è¿‡ç¨‹ä¸­, å¹¶æ²¡æœ‰ç”¨rangeçš„è¿­ä»£å™¨, åªæ˜¯ç”¨äº†ä»–çš„å®¹å™¨åŠŸèƒ½. ä¹Ÿå¯ä»¥è‡ªå·±è¯•ä¸‹, è¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬ä¸å®ç° __next__()æ–¹æ³•, åœ¨ <code>for in</code> ä¸­ç›´æ¥å›æŠ¥é”™, å› ä¸ºæ‰¾ä¸åˆ°next()æ–¹æ³•</p>
<p>è¿™é‡Œå¦‚æœæˆ‘ä»¬ä¸æŠ›å‡º <strong>å¼‚å¸¸ StopIteration</strong>, é‚£ä¹ˆå°±ä¼š<code>for in</code> ä¸€ç›´<code>next</code>, å½“<code>_index</code>è¶…è¿‡æ—¶å€™, <code>range</code>å°±ä¼šæŠ›å‡ºå¼‚å¸¸, è¯´æˆ‘ä»¬è¶Šç•Œ.</p>
<h2 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" class="headerlink" title="è¿­ä»£å™¨"></a>è¿­ä»£å™¨</h2><p>æˆ‘ä»¬è‡ªå·±æ¥ç»™å®ƒä¸‹ä¸€ä¸ªå®šä¹‰:</p>
<blockquote>
<ol>
<li>è¦å®ç°__iter__()æ–¹æ³•, å¹¶ä¸”è¿”å›çš„æ˜¯ self. (å¦‚æœè¿”å›çš„æ˜¯ç³»ç»Ÿçš„æˆ–è€…åˆ«çš„è¿­ä»£å™¨å¯¹è±¡, é‚£èƒ½ä¸èƒ½ä¹Ÿç®—å½“å‰è¿™ä¸ªç±»çš„, ä¾‹å¦‚ä¸Šé¢çš„ç¬¬ä¸€ç§æƒ…, æˆ‘ä¸çŸ¥é“, ä¹Ÿä¸çº ç»“äº†, è¿™é‡Œæš‚ä¸”å…ˆä¸ç®—å§)</li>
<li>è¦å®ç°__next__()æ–¹æ³•, å¹¶ä¸”åœ¨æ²¡æœ‰å€¼çš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸ StopIteration</li>
<li>è¦æ¯æ¬¡éƒ½è¿”å›ä¸ä¸€æ ·çš„å€¼, è¿˜åº”è¯¥è¦è®°å½•å½“å‰çš„çŠ¶æ€, ä¸Šåˆ—ä¸­ç”¨self._index è®°å½•äº†å½“å‰çš„ä½ç½®</li>
</ol>
</blockquote>
<h2 id="ç”Ÿæˆå™¨"><a href="#ç”Ÿæˆå™¨" class="headerlink" title="ç”Ÿæˆå™¨"></a>ç”Ÿæˆå™¨</h2><p>ç”Ÿæˆå™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿­ä»£å™¨ å®ƒä¸éœ€è¦å†åƒä¸Šé¢çš„ç±»ä¸€æ ·å†™__iter__()å’Œ__next__()æ–¹æ³•äº†ï¼Œåªéœ€è¦ä¸€ä¸ª<strong>yiled</strong>å…³é”®å­—ã€‚ç”Ÿæˆå™¨ä»¥ä¸€ç§æ‡’åŠ è½½çš„æ¨¡å¼ç”Ÿæˆå€¼. </p>
<p><strong>ç‰¹æ€§:</strong></p>
<blockquote>
<ol>
<li>å¯è¿­ä»£</li>
<li>æ‡’åŠ è½½</li>
<li>çŠ¶æ€ä¿å­˜</li>
<li>ä½¿ç”¨<code>yiled</code> å…³é”®å­—, æˆ–è€…ç”Ÿæˆå™¨è¡¨è¾¾å¼ åˆ›å»º.</li>
</ol>
</blockquote>
<pre><code>def gensquares(n):

for i in range(n):
    yield i ** 2

for item in gensquares(5):
    print(item)

outputs:
0, 1, 4, 9, 16
</code></pre><p>ç”Ÿæˆå™¨è¡¨è¾¾å¼å’Œåˆ—è¡¨æ¨åˆ°å¼å°±åªæœ‰ æ–¹æ‹¬å·å’Œ åœ†æ‹¬å·çš„åŒºåˆ«:</p>
<pre><code># åˆ—è¡¨æ¨å¯¼å¼
squares = [x ** 2 for x in range(5)]
print(squares)

output:
[0, 1, 4, 9, 16]

ç”Ÿæˆå™¨è¡¨è¾¾å¼:
squares = (x ** 2 for x in range(5))
print(squares)

for x in squares:
       print(x)

   outputs:
   &lt;generator object &lt;genexpr&gt; at 0x10e1a6410&gt;
0, 1, 4, 9, 16
</code></pre><p>æœ‰äººè¯´<code>yield</code>ç›¸å½“äº <code>return</code> è¿™é‡Œä¸¾ä¾‹æ¥çœ‹ä¸‹</p>
<pre><code>def frange(start, stop, increment):
x = start
while x &lt; stop:

    yield 8
    yield x  # è¿™é‡Œè¿”å›äº†ä¸€ä¸ªå€¼å, ä¸‹é¢çš„ä»£ç è¿˜æ˜¯æœ‰æ‰§è¡Œ
    x += increment


for n in frange(0, 4, 1):
    print(n)

outputs:
8, 0, 8, 1, 8, 2, 8, 3
</code></pre><blockquote>
<ol>
<li><code>return</code> åé¢çš„ä»£ç ä¸ä¼šæ‰§è¡Œ, <code>yield</code>åé¢çš„ä»£ç è¿˜æ˜¯ä¼šæ‰§è¡Œ.</li>
<li>å¤šä¸ª<code>return</code>æ—¶å€™, æ°¸è¿œåªæœ‰ç¬¬ä¸€ä¸ª<code>retrun</code>å€¼ä¼šè¢«è¿”å›, å¤šä¸ª<code>yield</code>æ—¶å€™, ä¸€æ¬¡ä¹Ÿåªæœ‰ç¬¬ä¸€ä¸ªè¿”å›, ä½†æ˜¯ä»–ä¼šè®°å½•ä¸Šæ¬¡è¿”å›<code>yield</code>çš„ä½ç½®. æ¯”å¦‚ä¸Šåˆ—ä¸­ ç¬¬ä¸€æ¬¡ è¿”å›çš„ç¬¬ä¸€ä¸ª<code>yield 8</code>, ç¬¬äºŒæ¬¡è¿”å›çš„æ˜¯ç¬¬äºŒä¸ª<code>yield 0</code>, ä¸‰æ¬¡åˆæ˜¯ç¬¬ä¸€ä¸ª<code>yield 8</code>â€¦ ä¹Ÿå°±æ˜¯è¯´ç”Ÿæˆå™¨ä¸­æœ‰ 8ä¸ªå…ƒç´ . å¦‚æœä½¿ç”¨<code>return</code> æ°¸è¿œåªä¼šè¿”å›8.</li>
</ol>
</blockquote>
<p><strong>ä¸€ä¸ªç”Ÿæˆå™¨åªèƒ½éå†è¯»å–ä¸€æ¬¡:</strong></p>
<pre><code>def frange(start, stop, increment):
x = start
while x &lt; stop:
    yield x  # è¿™é‡Œè¿”å›äº†ä¸€ä¸ªå€¼å, ä¸‹é¢çš„ä»£ç è¿˜æ˜¯æœ‰æ‰§è¡Œ
    x += increment

r = frange(0, 4, 1)

print(next(r))
print(next(r))
print(next(r))
print(next(r))

outputs:
0, 1, 2, 3
</code></pre><p>å¦‚æœå†åŠ ä¸€ä¸ª <code>print(next(r))</code> å°±ä¼šæŠ¥é”™, æç¤ºå¼‚å¸¸  <code>print(next(r)) StopIteration</code>. </p>
<p>ç°åœ¨å¯ä»¥æƒ³è±¡ä¸‹, åœ¨è‡ªå·±å®ç°è¿­ä»£å™¨æ—¶å€™, æˆ‘ä»¬åœ¨__iter__()æ–¹æ³•ä¸­, å¦‚æœè¿”å›ä¸€ä¸ª ç”Ÿæˆå™¨, æ˜¯å¦å¯è¡Œ, è€Œä¸”ä¸ç”¨å»å®ç°__next__()æ–¹æ³•ä¹Ÿ<strong>ä¸ä¼šæŠ¥é”™</strong>,å› ä¸ºç”Ÿæˆå™¨å¯¹è±¡é»˜è®¤ä¼šå®ç°, åªæ˜¯ç»“æœæ˜¯ä¸æ˜¯æƒ³è¦çš„å°±è¦æ€è€ƒä¸‹äº†.<br>è¿™é‡Œæ¥æ”¹ä¸‹ä¸Šé¢é‚£ä¸ªä¾‹å­, ç”¨ç”Ÿæˆå™¨æ”¹:</p>
<pre><code>class CustomList1(object):

def __init__(self):

        self._range = range(5)
        self._index = -1

    def __iter__(self):

        yield self


arr1 = CustomList1()
for i in arr1:
    print(i)

output: 
&lt;__main__.CustomList1 object at 0x1046deeb8&gt;
</code></pre><p> è¿™ä¸ªæ—¶å€™è¿”å›çš„æ˜¯ self è¿™ä¸ªå¯¹è±¡. é‚£æ˜¯ä¸æ˜¯æˆ‘ä»¬æŠŠ <code>__next__()</code> ä¹Ÿå®ç°å°±å¥½äº†?  å…¶å®ä¹Ÿæ˜¯ä¸€æ ·çš„, å› ä¸ºæ ¹æœ¬ä¸ä¼šå»è°ƒç”¨<code>__next__()</code>æ–¹æ³•. è‡³äºä¸ºå•¥ä¸ä¼šè°ƒç”¨, çŒœæƒ³çš„åŸå› æ˜¯ è¿™é‡Œè¿”å›çš„æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨, è€Œä¸æ˜¯è¿­ä»£å™¨, ç”Ÿæˆå™¨çš„æ˜¯ä¸€ä¸ªç³»ç»Ÿçš„ç±», è€Œè¿™é‡Œçš„<code>self</code>åªæ˜¯ ç”Ÿæˆå™¨å¯¹è±¡é‡Œçš„å®¹å™¨ä¸­çš„ä¸€ä¸ªå…ƒç´ . ä¹Ÿå°±æ˜¯è¯´ è¿™é‡Œè°ƒç”¨çš„æ˜¯ ç”Ÿæˆå™¨è¿™ä¸ªç±»çš„ <code>__next__()</code>æ–¹æ³•. è€Œä¸æ˜¯ selfçš„ <code>__next__()</code>.  ä¸¾ä¸ªä¾‹å­<br> <code>list1 = [1, 2, 3, 4]</code>  æˆ‘ä»¬åœ¨è¿­ä»£ listæ—¶å€™, æˆ‘ä»¬è°ƒç”¨çš„æ˜¯ list è¿™ä¸ªç±»å®ç°çš„<code>__next__()</code>æ–¹æ³•(å¯¹åº” ç”Ÿæˆå™¨), è€Œä¸æ˜¯listä¸­çš„å…ƒç´ çš„ 1æˆ–è€… 2 æˆ–è€… 3 ,4 çš„<code>next()</code> æ–¹æ³•(å¯¹åº”ä¾‹å­ä¸­çš„self).</p>
<p>è¦æ€æ ·æ‰èƒ½è¿”å›æˆ‘ä»¬æƒ³è¦çš„å‘¢? </p>
<pre><code>class CustomList1(object):

    def __init__(self):

        self._range = range(5)

    def __iter__(self):

        for i in self._range:
            yield i

arr1 = CustomList1()
for i in arr1:
    print(i)

arrIter = iter(arr1)
print(next(arrIter))
print(next(arrIter))
print(next(arrIter))
print(next(arrIter))
print(next(arrIter))

for in outputs: 
 0, 1, 2, 3, 4

 print outputs:
 0, 1, 2, 3, 4
</code></pre><p>è¿™ä¸ªç»“æœç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚, ä½†æ˜¯è¿™é‡Œä¸ºå•¥å¯ä»¥è¾“å‡ºä¸¤æ¬¡å‘¢? ä¸æ˜¯è¯´åªèƒ½è®¿é—®ä¸€æ¬¡å—? è¿™é‡Œæ˜¯å› ä¸ºè·å–äº†ä¸¤æ¬¡<code>arr1</code>å¯¹è±¡ çš„ è¿­ä»£å™¨å¯¹è±¡, è¿™ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€æ ·çš„. å½“æˆ‘ä»¬åœ¨å¾€åé¢åŠ ä¸€ä¸ª<code>print(next(arrIter))</code> é©¬ä¸Šå°±ä¼šæŠ¥å¼‚å¸¸ <code>StopIteration</code> å› ä¸ºåªèƒ½è¿”å›ä¸€æ¬¡.<br>ä¹Ÿå°±æ˜¯è¯´ æˆ‘ä»¬çš„CustomList1 ç±»æ˜¯æˆ‘ä»¬è‡ªå®ç°çš„ <strong>å¯è¿­ä»£çš„å®¹å™¨ç±»</strong>, <code>arr1</code> æ˜¯ä¸ªå®¹å™¨, åœ¨ä¸¤æ¬¡<code>iter(arr1)</code>æ—¶å€™, <code>obj1 =  iter(arr1)</code>, <code>obj2 =  iter(arr1)</code>, <code>obj1</code> å’Œ <code>obj2</code>æ˜¯<strong>ä¸ç›¸ç­‰çš„</strong>.</p>
<p>æˆ‘ä»¬å¯ä»¥åè¿‡æ¥æ€è€ƒä¸‹, åœ¨ä»‹ç»è¿­ä»£å™¨åè®®æ—¶å€™ ä¸¾ä¾‹çš„é‚£ä¸ªCustomList1ç±», å¦‚æœæ˜¯é‚£ä¸ª <code>arr1</code> å¯¹è±¡, åœ¨ä¸¤æ¬¡<code>iter(arr1)</code>æ—¶å€™, <code>obj1 =  iter(arr1)</code>, <code>obj2 =  iter(arr1)</code>, <code>obj1</code> å’Œ <code>obj2</code><strong>å¿…ç„¶æ˜¯ç›¸ç­‰çš„</strong>, å› ä¸ºåœ¨__iter__()ä¸­è¿”å›çš„self. éƒ½æ˜¯arr1æœ¬èº«. <strong>æ‰€ä»¥è¿™æ—¶å€™arr1æ˜¯è¿­ä»£å™¨,ä¸æ˜¯å®¹å™¨</strong>. è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯¹arr1 è¿›è¡Œä¸¤æ¬¡éå†. æƒ³è¦é‡æ–°è·å–ä¸€éé‡Œé¢çš„æ•°æ®é™¤éå†ç”Ÿæˆä¸€ä¸ªç±»ä¼¼<code>arr1</code> çš„<code>arr2</code>. <code>arr2 = CustomList1()</code>.</p>
<p>å¯¹æ¯”ä¸‹:</p>
<blockquote>
<pre><code>å¦‚æœæˆ‘ä»¬åœ¨\_\_iter\_\_() è¿”å›çš„æ˜¯ self, é‚£ä¹ˆè¿™ä¸ªç±»çš„å¯¹è±¡å°±æ˜¯ è¿­ä»£å™¨å¯¹è±¡, è€Œä¸æ˜¯å®¹å™¨å¯¹è±¡. å¦‚æœè¿”å›çš„æ˜¯ç³»ç»Ÿçš„å®¹å™¨å¯¹è±¡çš„è¿­ä»£å™¨å¦‚`iter(self._range)` æˆ–è€… ç”¨yieldçš„æ–¹å¼è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨é‚£ä¹ˆ, è¿™ä¸ªç±»çš„å¯¹è±¡å°±æ˜¯ å®¹å™¨å¯¹è±¡.

å®¹å™¨å¯¹è±¡å¦‚æœæƒ³é‡æ–°è·å–ä¸€éé‡Œé¢çš„å€¼, åªéœ€è¦è·å–ä¸€ä¸ªæ–°çš„ è¿­ä»£å™¨å¯¹è±¡, `obj1 = iter(arr1)`, å°±èƒ½é€šè¿‡è¿­ä»£`obj1`çš„éå†é‡æ–°è·å–. è¿­ä»£å™¨å¯¹è±¡è‡ªèº«æ˜¯æ— æ³•å†é‡æ–°è·å–çš„, åªèƒ½é€šè¿‡å†åˆ›å»ºä¸€ä¸ª å½“å‰è¿­ä»£å™¨å¯¹è±¡çš„å…„å¼Ÿå¯¹è±¡ `arr2 = CustomList1(), obj1 = iter(arr12)`  ç„¶åé€šè¿‡obj1é‡æ–°è·å–.
</code></pre></blockquote>
</article><ul class="pager blog-pager"><li class="next"><a href="/2017/06/12/runtimeåœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨-äºŒ-è‡ªå®šä¹‰KVO/" data-toggle="tooltip" data-placement="top" title="runtimeåœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨(äºŒ)-è‡ªå®šä¹‰KVO">Next Post â†’</a></li></ul><div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div><script src="//img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"> </script><script>var cloudTieConfig = {
  url: document.location.href, 
  sourceId: "",
  productKey: "b2936902a3964ebcbfb2b9b06b133401",
  target: "cloud-tie-wrapper"
};</script></div></div></div><footer><div class="container beautiful-jekyll-footer"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href="https://github.com/shinyYangYang" title="GitHub"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-github"></i></span></a></li><li><a href="https://twitter.com/shinyYangYang" title="Twitter"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-twitter"></i></span></a></li><li><a href="mailto:yangyang_swift@sina.com" title="Email me"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-envelope"></i></span></a></li></ul><p class="copyright text-muted">Â© æ¨é˜³ â€¢ 2018 â€¢ <a href="mailto:undefined"></a>
</p><p class="theme-by text-muted">Theme by
<a href="https://github.com/twoyao/beautiful-hexo">beautiful-hexo</a></p></div></div></div></footer><script src="//cdn.bootcss.com/jquery/1.11.2/jquery.min.js"></script><script src="//cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/js/main.js"></script><script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>